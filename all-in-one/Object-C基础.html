<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Object-C基础</title>
  <style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}

ul.task-list[class]{list-style: none;}
ul.task-list li input[type="checkbox"] {
font-size: inherit;
width: 0.8em;
margin: 0 0.8em 0.2em -1.6em;
vertical-align: middle;
}

html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
  <style type="text/css">html {scroll-behavior: smooth;}body {font-size: 1rem;line-height: 1.6;tab-size: 4;color: rgb(51, 51, 51);font-family: Microsoft YaHei,"Open Sans","Clear Sans", "Helvetica Neue", Helvetica, Arial, 'Segoe UI Emoji', sans-serif;-webkit-font-smoothing: antialiased;position: relative;top: 0;left: 300px;width: calc(90% - 300px);padding: 2em 5%;}h1,h2,h3,h4,h5,h6 {position: relative;margin-top: 1rem;margin-bottom: 1rem;padding-bottom: 0;font-weight: bold;line-height: 1.4;cursor: text;}h1 {font-size: 2.25em;line-height: 1.2;border-bottom: 1px solid #eee;}h2 {font-size: 1.75em;line-height: 1.225;border-bottom: 1px solid #eee;}h3 {font-size: 1.5em;line-height: 1.43;}h4 {font-size: 1.25em;}h5 {font-size: 1em;}h6 {font-size: 1em;color: #777;}p,blockquote{ margin: 0.8em 0 !important; }ul,ol,dl,table{margin: 0.8em 0;}li>ol,li>ul {margin: 0 0;}a {color: #4183C4;text-decoration: none;}hr {height: 2px;padding: 0;margin: 16px 0;background-color: #e7e7e7;border: 0 none;overflow: hidden;box-sizing: content-box;}li p.first {display: inline-block;}ul,ol {padding-left: 20px;}ul:first-child,ol:first-child {margin-top: 0;}ul:last-child,ol:last-child {margin-bottom: 0;}blockquote {border-left: 4px solid #dfe2e5 !important;padding: 0 15px;color: #777777 !important;background-color: #ffffff !important;}blockquote blockquote {padding-right: 0;}table {padding: 0;word-break: initial;border-collapse: collapse;}table tr {border: 1px solid #dfe2e5;margin: 0;padding: 0;}table tr:nth-child(2n),thead {background-color: #f8f8f8;}table th {font-weight: normal;text-align: unset;border-bottom: 0;border: 1px solid #dfe2e5;margin: 0;padding: 6px 13px;}table td {border: 1px solid #dfe2e5;margin: 0;padding: 6px 13px;}table th:first-child,table td:first-child {margin-top: 0;}table th:last-child,table td:last-child {margin-bottom: 0;}tt {border: 1px solid #e7eaed;background-color: #f8f8f8;border-radius: 3px;padding: 2px 4px 0px 4px;font-size: 0.9em;}code {border: 1px solid #e7eaed;background-color: #f3f4f4;border-radius: 3px;padding: 0 2px 0 2px;font-size: 0.9em;}img {width: 50%;height: 50%;display: block;vertical-align: middle;image-orientation: from-image;margin: auto;}figcaption {text-align: center;}pre>code{counter-reset: linenumber;display: block;white-space: pre;overflow: auto !important;padding: 0.2em;border-radius: 7px;}pre>code>span {counter-increment: linenumber;display: inline-block;line-height: 1.25em !important;}pre>code>span::before {content: counter(linenumber);display: inline-block;font-size: 0.9em;color: #999;min-width: 1.8em;margin-right: 0.5em;padding-right: 0.25em;text-align: right;border-right: 1px solid #999;line-height: 1.9em;user-select: none;pointer-events: none;}#TOC {font-size: 0.8rem;position: fixed;top: 0;left: 0;width: 300px;height: 100%;padding: 32px 16px 48px 16px !important;box-shadow: 0 0 4px rgba(150,150,150,0.33);box-sizing: border-box;overflow: auto;}#TOC::-webkit-scrollbar{width: 1px;border-right: 1px solid #f5f5f5;}#TOC a{color: #333333;text-decoration: none;}#TOC a:hover{color: #333333 !important;text-decoration: underline !important;}#TOC ul { list-style: none; }#TOC li { margin-bottom: 0.25rem; }@media (max-width: 700px) {#TOC { display: none; }body { left: 0px; width: 90%; }}</style>
  <script type="text/javascript">
  window.onload = function(){
    document.querySelectorAll('a[href^="#"]').forEach(function(item,index,arr){
        item.addEventListener('click', function(e) {
            e.preventDefault();
            const target =  document.getElementById(decodeURI((item.href.substring(item.href.indexOf('#')+1))));
            if(target == null) { return; }
            target.scrollIntoView({ behavior: 'smooth' });
        });
    })
    const toc_a = document.querySelectorAll('#TOC a');
    function updateTOC(){
      const scrollPosition = window.scrollY;
      let highlightTarget;
      for(let i=toc_a.length-1; i>=0; i--){
        const target = document.getElementById(decodeURI((toc_a[i].href.substring(toc_a[i].href.indexOf('#')+1))));
        if(target == null) { continue; }
        const ItemPosition = target.offsetTop;
        if (scrollPosition > ItemPosition && typeof(highlightTarget) == "undefined") {
          highlightTarget = toc_a[i];
        } else if(typeof(highlightTarget) == "undefined" && i == 0) {
          highlightTarget = toc_a[0];
        }
      }
      toc_a.forEach( item => {
        item.style.fontWeight = "";
      });
      if(typeof(highlightTarget) == "undefined") { return; }
      highlightTarget.style.fontWeight = "bold";
    }
    let timer = null;
    window.addEventListener('scroll', () => {
      window.clearTimeout(timer);
      timer = window.setTimeout(() => { updateTOC() }, 200);
    });
  };
  </script>
  <base target="_blank">
</head>
<body>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#c语言基础" id="toc-c语言基础">C语言基础</a>
<ul>
<li><a href="#变量类型与输入输出" id="toc-变量类型与输入输出">变量类型与输入输出</a></li>
<li><a href="#函数" id="toc-函数">函数</a></li>
<li><a href="#数组" id="toc-数组">数组</a></li>
<li><a href="#字符串与指针" id="toc-字符串与指针">字符串与指针</a></li>
<li><a href="#预处理指令" id="toc-预处理指令">预处理指令</a></li>
<li><a href="#static和extern" id="toc-static和extern">static和extern</a></li>
<li><a href="#结构体" id="toc-结构体">结构体</a></li>
<li><a href="#枚举" id="toc-枚举">枚举</a></li>
<li><a href="#typedef" id="toc-typedef">typedef</a></li>
</ul></li>
<li><a href="#object-c" id="toc-object-c">Object-C</a>
<ul>
<li><a href="#基本语法" id="toc-基本语法">基本语法</a></li>
<li><a href="#内存管理" id="toc-内存管理">内存管理</a></li>
<li><a href="#category和extension" id="toc-category和extension">Category和Extension</a></li>
<li><a href="#protocol" id="toc-protocol">Protocol</a></li>
<li><a href="#block" id="toc-block">Block</a></li>
<li><a href="#copy和mutablecopy" id="toc-copy和mutablecopy">copy和mutableCopy</a></li>
</ul></li>
<li><a href="#ios开发" id="toc-ios开发">IOS开发</a>
<ul>
<li><a href="#控件获取" id="toc-控件获取">控件获取</a></li>
<li><a href="#平移缩放旋转动画" id="toc-平移缩放旋转动画">平移、缩放、旋转、动画</a></li>
<li><a href="#点击事件" id="toc-点击事件">点击事件</a></li>
<li><a href="#代码动态创建" id="toc-代码动态创建">代码动态创建</a>
<ul>
<li><a href="#纯代码方式" id="toc-纯代码方式">纯代码方式</a></li>
<li><a href="#加载xib文件方式" id="toc-加载xib文件方式">加载xib文件方式</a></li>
<li><a href="#加载配置文件" id="toc-加载配置文件">加载配置文件</a></li>
</ul></li>
<li><a href="#常用控件" id="toc-常用控件">常用控件</a>
<ul>
<li><a href="#uiscrollview" id="toc-uiscrollview">UIScrollView</a></li>
<li><a href="#uitableview" id="toc-uitableview">UITableView</a></li>
</ul></li>
<li><a href="#应用图标和启动图" id="toc-应用图标和启动图">应用图标和启动图</a></li>
<li><a href="#通知" id="toc-通知">通知</a></li>
<li><a href="#键盘" id="toc-键盘">键盘</a></li>
<li><a href="#autolayout" id="toc-autolayout">AutoLayout</a></li>
<li><a href="#多线程" id="toc-多线程">多线程</a></li>
</ul></li>
</ul>
</nav>
<h2 id="c语言基础">C语言基础</h2>
<h3 id="变量类型与输入输出">变量类型与输入输出</h3>
<p>变量类型和所占空间大小（单位：byte）：</p>
<table>
<thead>
<tr>
<th></th>
<th>16位编译器</th>
<th>32位编译器</th>
<th>64位编译器</th>
</tr>
</thead>
<tbody>
<tr>
<td>char</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>void *(指针)</td>
<td>2</td>
<td>4</td>
<td>8</td>
</tr>
<tr>
<td>short int</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>unsigned int</td>
<td>2</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>int</td>
<td>2</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>unsigned long</td>
<td>4</td>
<td>4</td>
<td>8</td>
</tr>
<tr>
<td>long</td>
<td>4</td>
<td>4</td>
<td>8</td>
</tr>
<tr>
<td>long long</td>
<td>8</td>
<td>8</td>
<td>8</td>
</tr>
<tr>
<td>float</td>
<td>4</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>double</td>
<td>8</td>
<td>8</td>
<td>8</td>
</tr>
</tbody>
</table>
<p>按作用域分，变量可以分为全局变量和局部变量</p>
<p>按存储类型分，变量可以分为自动变量（存储在运行时堆栈）、静态变量（存储在静态内存）、寄存器变量（存储在硬件寄存器）</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">//全局变量，所有的全局变量都是静态变量，或者被static修饰的局部变量也是静态变量（此时只有第一次执行的时候才会被初始化）</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> b<span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> test<span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">static</span> <span class="dt">int</span> a <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    a<span class="op">++;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> a<span class="op">);</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span> argv<span class="op">[]){</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">//变量定义并初始化，局部变量如果不初始化可能是垃圾数据、全局变量或static变量有默认初始值</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">//自动变量，默认情况下所有局部变量都是自动变量，可以用auto修饰，这时auto可以省略</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">float</span> a <span class="op">=</span> <span class="fl">1.55</span><span class="op">;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    test<span class="op">();</span><span class="co">//输出1</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    test<span class="op">();</span><span class="co">//输出2，此时static int a = 0 不会再被执行</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">//寄存器变量，只有局部的自动变量才可以是寄存器变量，寄存器变量仅限int、char和指针类型使用</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">//若寄存器变量太多，超过了硬件寄存器的数量时，寄存器变量会自动变成自动变量</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="dt">register</span> <span class="dt">int</span> b <span class="op">=</span> <span class="dv">1</span>；</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">//输出格式控制</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">//可以控制保留的小数点位数、占的字符个数（对齐左或右），是否补零</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">  </span><span class="sc">%.3d</span><span class="st">  </span><span class="sc">%4.2d</span><span class="st">  </span><span class="sc">%-4.2d</span><span class="st"> </span><span class="sc">%04.2d\n</span><span class="st">&quot;</span><span class="op">,</span> a<span class="op">,</span> a<span class="op">,</span> a<span class="op">,</span> a<span class="op">,</span> a<span class="op">);</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="co">//获取输入</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>a<span class="op">);</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="函数">函数</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">//如果要在定义前使用函数，则需要先声明，再使用</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sum2<span class="op">(</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">);</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sum1<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">+</span> b<span class="op">;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    sum1<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">//程序是按顺序执行的，此前已经有sum1但没有sum2，sum2需先声明，再使用</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    sum2<span class="op">(</span><span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sum2<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">+</span> b<span class="op">;</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="数组">数组</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">//和其他语言不同，中括号必须写在变量名后面，且数组长度不能是变量（不同编译器有不同的规则，但标准情况下不允许）</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> a<span class="op">[</span><span class="dv">5</span><span class="op">];</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">//赋值</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>a<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">//a = {1, 2, 3, 4, 5};//错误，数组是个常量，不能重新指向</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">//数组名就是数组首元素的地址，是一个常量，不可修改</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%x</span><span class="st"> &amp;x </span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> a<span class="op">,</span> <span class="op">&amp;</span>a<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">//初始化</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> b<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> c<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span><span class="co">//但对全部元素赋予初始值时，可以省略元素个数</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> d<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span><span class="co">//省略部分。即d[2]、d[3]默认为0</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">//当数组作为函数形参时，长度可以不写，这时如果对函数形参的a作修改，会把外部a也修改掉</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> func1<span class="op">(</span><span class="dt">int</span> a<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    a<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>func1<span class="op">(</span>a<span class="op">);</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co">//二维数组可以省略列数，但行数不能省略</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> e<span class="op">[</span><span class="dv">3</span><span class="op">][]</span> <span class="op">=</span> <span class="op">{{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">},</span> <span class="op">{</span><span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">},</span> <span class="op">{</span><span class="dv">6</span><span class="op">,</span> <span class="dv">7</span><span class="op">}};</span></span></code></pre></div>
<h3 id="字符串与指针">字符串与指针</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">//字符串可以使用字符数组存储，但最后要加一个结束符</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> a<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="ch">&#39;a&#39;</span><span class="op">,</span> <span class="ch">&#39;b&#39;</span><span class="op">,</span> <span class="ch">&#39;c&#39;</span><span class="op">,</span> <span class="ch">&#39;</span><span class="sc">\0</span><span class="ch">&#39;</span><span class="op">};</span><span class="co">//在c中char占一个字节，而一个中文占3个字节，所以不能用char数组存储中文</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> b<span class="op">[]</span> <span class="op">=</span> <span class="st">&quot;abc&quot;</span><span class="op">;</span><span class="co">//和上面等价，会在最后自动加结束符</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">//字符串输入输出，如果输入字符数大于数组长度，会发生越界，但不会报错</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> c<span class="op">[</span><span class="dv">20</span><span class="op">];</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%s</span><span class="st">&quot;</span><span class="op">,</span> c<span class="op">);</span><span class="co">//或者gets(c)，scanf不能读取空格或Tab，但gets能</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%s</span><span class="st">&quot;</span><span class="op">,</span> c<span class="op">);</span><span class="co">//或者puts(c)</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;字符串长度：</span><span class="sc">%d</span><span class="st">，字符数组长度：</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> strlen<span class="op">(</span><span class="st">&quot;中文&quot;</span><span class="op">),</span> strlen<span class="op">(</span>b<span class="op">));</span><span class="co">//长度不包括结束符</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">//使用指针存储字符串</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">//和数组不同，这样定义的是字符串常量，*d不能再被更改，相当于const char *d = &quot;abcdef&quot;</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> <span class="op">*</span>d <span class="op">=</span> <span class="st">&quot;abcdef&quot;</span><span class="op">;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">//指针加1表示加的是指针所指类型的长度，而不是地址加1</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(;</span> <span class="op">*</span>d<span class="op">!=</span><span class="ch">&#39;</span><span class="sc">\0</span><span class="ch">&#39;</span><span class="op">;</span> d<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%c\n</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">*</span>d<span class="op">);</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co">//函数指针</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">(*</span>e<span class="op">)(</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">);</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>e <span class="op">=</span> sum1<span class="op">;</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="op">(*</span>e<span class="op">)(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span></code></pre></div>
<h3 id="预处理指令">预处理指令</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">//宏定义，编译前会把 所有宏展开成对应的值（可以带变量）</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define SIZE_5 </span><span class="dv">5</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">//如果#define mul(a, b) a*b，那么mul(5+5, 10)/mul(2, 2)会变成5+5*10/2*2等于55</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define mul</span><span class="op">(</span><span class="pp">a</span><span class="op">,</span><span class="pp"> b</span><span class="op">)</span><span class="pp"> </span><span class="op">((</span><span class="pp">a</span><span class="op">)*(</span><span class="pp">b</span><span class="op">))</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">//宏定义也可以只定义，不替换</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#define AAA</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">//条件编译（不能用代码中的变量，只能使用宏定中义定义的变量做条件，因为是在编译前展开的）</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="pp">#if !defined(AAA)</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">//code1</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="pp">#elif !defined(BBB)</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">//code2</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="pp">#else</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">//code3</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co">//如果定义过某个宏则执行</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifdef AAA</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">//code</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co">//如果没有定义过某个宏则执行</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef AAA</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">//code</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="co">//文件包含，可以嵌套包含（但会降低编译效率，尽量配合宏和条件编译使用），但不能循环包含</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="co">//尖括号表示从C语言函数库中找，双引号表示从当前路径中找，如果找不到，再去操作系统的path路径中找</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;stdio.h&quot;</span></span></code></pre></div>
<h3 id="static和extern">static和extern</h3>
<p>不同的源文件不能有同名的外部函数，不同的源文件可以有同名的内部函数</p>
<p>用extern修饰的函数是外部函数，完整地声明一个外部函数也可以使用extern修饰，默认情况下，所有函数都是外部函数，所以extern可以省略不写（包括定义和声明）</p>
<p>用static修饰的函数时内部函数，无法被文件外访问，内部函数的声明也需要static修饰</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="op">--------------</span>aaa<span class="op">.</span>c<span class="op">--------------</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">//定义一个外部函数，extern可以省略</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="kw">extern</span> <span class="dt">void</span> aaa<span class="op">(){}</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">//定义一个内部函数</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> <span class="dt">void</span> bbb<span class="op">(){}</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="op">--------------</span>bbb<span class="op">.</span>c<span class="op">--------------</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">//声明一个外部函数，extern可以省略（实际开发中，我们一般会给每个c文件创建一个头文件来存储函数声明，所以更常见的作法是直接include对应的头文件，而不是直接在这里声明）</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">//一个程序从源码到可执行文件需要经过 编译、链接、运行，在链接时才会找当前路径下的其他obj文件的函数，因此如果不提前声明一个外部函数，是编译不通过的，因为不知道这个函数的存在，也就无从链接了（如果声明了但是函数不存在，则链接时会报错）</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="kw">extern</span> <span class="dt">void</span> aaa<span class="op">();</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    aaa<span class="op">();</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">//bbb();//错误，无法访问其他源文件的内部函数</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>对于变量，extern只能用于声明变量，不能用于定义变量</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">//声明全局变量a，此时extern也可以省略（即默认是外部变量），这样的话看起来就像声明了两次（甚至多次），但编译器认为一个是声明其他是定义</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">//由于可重复定义，如果不同的源文件包含一个同名的全局变量，不会报错，而且用的是同一个变量</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">//要使用其他源文件中定义的外部变量，只声明，不定义即可（但变量的声明和定义都可以写成&quot;int a;&quot;）</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="kw">extern</span> <span class="dt">int</span> a<span class="op">;</span><span class="co">//由于extern只能用于声明变量，不能用于定义变量，所以带extern一定是声明变量</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">//在局部中声明的变量，如果使用extern，表示使用的是全局中对应的变量，而不是新的局部变量</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">//extern int a;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">//在定义前就使用变量需提前声明</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">//定义变量a</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> a<span class="op">;</span></span></code></pre></div>
<p>static修饰的局部变量，前面说过，会变成静态变量，只有第一次执行时才会被初始化，生命周期到程序结束为止</p>
<p>static修饰的全局变量，和函数相似，表示内部变量，只能在当前源文件中访问，外部无法访问（此时声明和定义都是”static
int a;“）</p>
<h3 id="结构体">结构体</h3>
<p>结构体和类相似，但它不能定义方法，只能定义属性，而且结构体不能递归定义，即结构体中不能包含该结构体本身，但可以包含其他结构体</p>
<p>结构体使用值传递</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">//定义一个结构体</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Student1 <span class="op">{</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> age<span class="op">;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span><span class="op">*</span> name<span class="op">;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">float</span> height<span class="op">;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">//使用结构体，构造类型（数组、结构体）在初始化时可以使用大括号初始化数据（但之后不允许这样赋值）</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Student1 stu1 <span class="op">=</span> <span class="op">{</span><span class="dv">18</span><span class="op">,</span> <span class="st">&quot;haha&quot;</span><span class="op">,</span> <span class="fl">1.66</span><span class="bu">f</span><span class="op">};</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;age：</span><span class="sc">%d</span><span class="st">，name：</span><span class="sc">%s</span><span class="st">，height：</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> stu1<span class="op">.</span>age<span class="op">,</span> stu1<span class="op">.</span>name<span class="op">,</span> stu1<span class="op">.</span>height<span class="op">);</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">//在定义结构体的同时创建一个结构体变量并初始化</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Date1 <span class="op">{</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> year<span class="op">;</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> month<span class="op">;</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> day<span class="op">;</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> date1 <span class="op">=</span> <span class="op">{</span><span class="dv">2008</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">};</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co">//在定义结构体的同时创建一个结构体数组</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Date2 <span class="op">{</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> year<span class="op">;</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> month<span class="op">;</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> day<span class="op">;</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> date2<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span> <span class="op">{</span><span class="dv">2008</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="op">{</span><span class="dv">2009</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">}</span> <span class="op">};</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="co">//定义一个没有名字的结构体，并创建对应变量并初始化</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> <span class="op">{</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> age<span class="op">;</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span><span class="op">*</span> name<span class="op">;</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    <span class="dt">float</span> height<span class="op">;</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> stu2 <span class="op">=</span> <span class="op">{</span><span class="dv">18</span><span class="op">,</span> <span class="st">&quot;haha&quot;</span><span class="op">,</span> <span class="fl">1.66</span><span class="bu">f</span><span class="op">};</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="co">//结构体中包含其他结构体</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Student3 <span class="op">{</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> age<span class="op">;</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Date1 birthday<span class="op">;</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Student3 stu3 <span class="op">=</span> <span class="op">{</span><span class="dv">18</span><span class="op">,</span> <span class="op">{</span><span class="dv">2008</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">}};</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="co">//结构体使用值传递</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>func1<span class="op">(</span>Student3 stu<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    stu<span class="op">.</span>age <span class="op">=</span> <span class="dv">20</span><span class="op">;</span><span class="co">//无法改变外部的stu3中的值</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>func1<span class="op">(</span>stu3<span class="op">);</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;age：</span><span class="sc">%d</span><span class="st">，year：</span><span class="sc">%d</span><span class="st">，month：</span><span class="sc">%d</span><span class="st">，day：</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> stu3<span class="op">.</span>age<span class="op">,</span> stu3<span class="op">.</span>birthday<span class="op">.</span>year<span class="op">,</span> stu3<span class="op">.</span>birthday<span class="op">.</span>month<span class="op">,</span> stu3<span class="op">.</span>birthday<span class="op">.</span>day<span class="op">);</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a><span class="co">//使用指针操作结构体，使用箭头访问属性</span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Student3 <span class="op">*</span>p <span class="op">=</span> <span class="op">&amp;</span>stu3<span class="op">;</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;age：</span><span class="sc">%d</span><span class="st">, p-&gt;age);</span></span></code></pre></div>
<h3 id="枚举">枚举</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>emun Season <span class="op">{</span> spring<span class="op">,</span> summer<span class="op">,</span> autumn<span class="op">,</span> winter<span class="op">};</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">//创建枚举变量</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>emun Season s <span class="op">=</span> spring<span class="op">;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">//枚举可以当作整型处理，spring对应0, summer对应1，...</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>s  <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">//这个性质可以用于遍历</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span>s <span class="op">=</span> spring<span class="op">;</span> s <span class="op">&lt;=</span> winter<span class="op">;</span> s<span class="op">++)</span> <span class="op">{</span> printf<span class="op">(</span><span class="st">&quot;枚举元素：</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> s<span class="op">);</span> <span class="op">}</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">//如果赋的整型超出范围，不会报错</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">//summer如果手动赋值为3，那么autumn就对应4，...</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">//emun Season { spring, summer=3, autumn, winter};</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">//和结构体类似，也可以在定义枚举的同时创建枚举变量</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">//emun Season { spring, summer, autumn, winter} s = spring;</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co">//也可以省略枚举名称</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co">//emun { spring, summer, autumn, winter} s = spring;</span></span></code></pre></div>
<h3 id="typedef">typedef</h3>
<p>使用typedef可以给已存在的类型起别名</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">int</span> Integer<span class="op">;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">unsigned</span> <span class="dt">int</span> UInteger<span class="op">;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">//typedef的类型可以再次取别名</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> Integer MyInteger<span class="op">;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">//可以给指针、结构体、枚举、函数指针取别名（结构体、枚举的名称可以省略）</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">char</span> <span class="op">*</span> String<span class="op">;</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> <span class="op">{</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> age<span class="op">;</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> Student1<span class="op">;</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> emun <span class="op">{</span> spring<span class="op">,</span> summer<span class="op">,</span> autumn<span class="op">,</span> winter<span class="op">}</span> Season<span class="op">;</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">int</span> <span class="op">(*</span>PSum<span class="op">)(</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">);</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">//给指向结构体的指针起别名</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">//typedef Student1 * PStudent;</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">//或者</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> Student2 <span class="op">{</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> age<span class="op">;</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="op">*</span> PStudent<span class="op">;</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co">//使用</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>Integer a <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>Student1 stu1 <span class="op">=</span> <span class="op">{</span> <span class="dv">18</span> <span class="op">};</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>Season season <span class="op">=</span> spring<span class="op">;</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sum<span class="op">(</span><span class="dt">int</span> a<span class="op">.</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> a<span class="op">+</span>b<span class="op">;</span> <span class="op">}</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>PSum psum <span class="op">=</span> sum<span class="op">;</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>Student2 stu2 <span class="op">=</span> <span class="op">{</span> <span class="dv">19</span> <span class="op">};</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>PStudent pstu <span class="op">=</span> <span class="op">&amp;</span>stu2<span class="op">;</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>pstu<span class="op">-&gt;</span>age <span class="op">=</span> <span class="dv">20</span><span class="op">;</span></span></code></pre></div>
<p>注意typedef和宏定义的区别</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">char</span> <span class="op">*</span> String1<span class="op">;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define String2 </span><span class="dt">char</span><span class="pp"> </span><span class="op">*;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>String1 s1<span class="op">,</span> s2<span class="op">;</span><span class="co">//s1和s2都是char*</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>String2 s3<span class="op">,</span> s4<span class="op">;</span><span class="co">//s3是char*，s4是char</span></span></code></pre></div>
<h2 id="object-c">Object-C</h2>
<h3 id="基本语法">基本语法</h3>
<p>Object-C是基于C的，在C的基础上加上了一层面向对象的语法，所以Object-C中可以混用C甚至C++代码</p>
<p>为了与C、C++中的关键字、字符串区分开，Object-C中的关键字和字符串都是以<code>@</code>开头的</p>
<p>Object-C文件的后缀是<code>.m</code>，而且也有头文件<code>.h</code>，<code>.h</code>中使用<code>@interface</code>和<code>@end</code>声明一个类，<code>.m</code>中使用<code>@implementation</code>和<code>@end</code>实现一个类</p>
<p>相比C，Object-C： -
有<code>BOOL</code>类型，取值为<code>YES</code>、<code>NO</code> -
有空类型<code>nil</code> - 支持快速for循环<code>for(xxx in xxx)</code> -
基类一般是<code>NSObject</code>，类只支持单继承 -
类中使用<code>self</code>引用本身（如果是类方法使用self，则代表类名）、用<code>super</code>引用父类
-
日志输出使用<code>NSLog(@&quot;num is %i&quot;, 10)</code>，此时格式控制符和C有所不同</p>
<p>和Java不同： -
给nil调用某个方法，不会发送空指针异常，这时会忽略此次调用 -
给已经释放内存的对象调用某个方法，会发生野指针错误 -
给某个对象调用一个不存在的方法，会发生”unrecognized selector sent to
instance
xxx”错误，通过<code>[xxx respondsToSelector(@selector(方法名))]</code>可以检测对象是否实现了某个方法，但是要注意，冒号也是方法名的一部分，而且方法名不需要双引号包裹</p>
<p><strong>Hello World</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">//使用#import如果重复包含，则不会导入，这样就不需要写条件编译的宏了</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>argv<span class="op">[])</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    NSLog<span class="op">(</span><span class="st">@&quot;Hello World&quot;</span><span class="op">);</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>类</strong></p>
<p>知识点： - 使用<code>#import</code>进行导入 -
类的声明（<code>@interface</code>、<code>@end</code>）和定义（<code>@implementation</code>、<code>@end</code>）
- 成员变量命名规范，要带下划线 - 自定义构造函数 -
函数参数和函数返回值的写法 -
由于点语法的存在，get、set中不能直接使用<code>self.xxx</code>，否则会导致死循环
- 直接访问类的公共成员变量 - 多个参数的函数写法 -
使用<code>#pragma</code>注释 -
使用<code>@property</code>和<code>@synthesize</code>自动生成get、set方法
- description函数，以及使用<code>NSLog(@&quot;%@&quot;, xxx)</code>打印对象 -
类的创建和释放<code>[[XXX alloc] init]</code>或<code>[XXX new]</code>，以及<code>[xxx release]</code></p>
<p>Student.h</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="kw">@interface</span> Student <span class="op">:</span> NSObject <span class="op">{</span><span class="co">//大括号中写成员变量</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">//成员变量建议用下划线前缀</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">//默认是protected</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> _age<span class="op">;</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> _num<span class="op">;</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">//使用@synthesize自动生成get、set方法的成员变量最好不要带下划线前缀，而且此时这里的声明是可以省略的</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">//float height;</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">/*</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">    //也可以指定作用域</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">    //_num1、_num2、_num3都是public的，下面的同理</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">    @public</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">    int _num1;</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">    int _num2;</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">    int _num3;</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">    @protected</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co">    int _num4;</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co">    int _num5;</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co">    @private</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co">    int _num6;</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co">    */</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co">//自定义构造函数</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co">//id表示任意类型的指针，也可以返回Student*，或者使用instancetype表示当前类的类型的指针（instancetype只能用在返回值上，而id可以作为普通的类型使用）</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span>id<span class="op">)</span>initWithAge<span class="op">:(</span><span class="dt">int</span><span class="op">)</span>age<span class="op">;</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="co">//在&quot;.h&quot;文件中声明的方法都是公共方法，直接在&quot;.m&quot;文件中写的方法是私有方法</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="co">// &quot;+&quot;表示类方法（通过类名调用），&quot;-&quot;表示对象方法（或者叫动态方法，通过对象调用）</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="co">//所有类型都用括号括住</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="co">//get方法建议写成和变量名一样（不带下划线）</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>age<span class="op">;</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="co">//一个冒号对应一个参数</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>setAge<span class="op">:(</span><span class="dt">int</span><span class="op">)</span>age<span class="op">;</span><span class="co">//方法名为setAge:</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a><span class="co">//num的get、set方法</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>num<span class="op">;</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>setNum<span class="op">:(</span><span class="dt">int</span><span class="op">)</span>num<span class="op">;</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a><span class="co">//自动生成get、set方法的声明（在XCode4.5以上，可以省略&quot;.m&quot;文件中的@synthesize，@property会在&quot;.m&quot;文件中自动生成带下划线前缀的私有成员变量，并生成对应的get、set方法，如果实现了get、set方法其中一个，则自动生成另一个）</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>@property <span class="dt">float</span> height<span class="op">;</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a><span class="co">//多个参数的函数</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>setAge<span class="op">:(</span><span class="dt">int</span><span class="op">)</span>age andNum<span class="op">:(</span><span class="dt">int</span><span class="op">)</span>num<span class="op">;</span><span class="co">//方法名为setAge:andNum:</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span></code></pre></div>
<p>Student.m</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;Student.h&quot;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="kw">@implementation</span> Student</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span>id<span class="op">)</span>initWithAge<span class="op">:(</span><span class="dt">int</span><span class="op">)</span>age <span class="op">{</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span><span class="op">(</span><span class="kw">self</span> <span class="op">=</span> <span class="op">[</span><span class="kw">super</span> init<span class="op">])</span> <span class="op">{</span><span class="co">//分配内存出错时，self可能为空，为空则if不执行（省略了!=nil）</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        _age <span class="op">=</span> age<span class="op">;</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="kw">self</span><span class="op">;</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>age <span class="op">{</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> _age<span class="op">;</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>setAge<span class="op">:(</span><span class="dt">int</span><span class="op">)</span>age <span class="op">{</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    _age <span class="op">=</span> age<span class="op">;</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>num <span class="op">{</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> _num<span class="op">;</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>setNum<span class="op">:(</span><span class="dt">int</span><span class="op">)</span>num <span class="op">{</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    _num <span class="op">=</span> num<span class="op">;</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="pp">#pragma mark 函数的注释，支持XCode快速定位</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>setAge<span class="op">:(</span><span class="dt">int</span><span class="op">)</span>age andNum<span class="op">:(</span><span class="dt">int</span><span class="op">)</span>num <span class="op">{</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    _age <span class="op">=</span> age<span class="op">;</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    _num <span class="op">=</span> num<span class="op">;</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="co">//XCode4.5以后，不需要写&quot;@synthesize&quot;，&quot;@property&quot;在生成声明的同时也会生成对应的get、set方法实现</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a><span class="co">//自动生成get、set方法，要求定义的成员变量不要带下划线前缀</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="co">//如果对应的成员变量不存在，会在&quot;.m&quot;文件中自动生成，即&quot;.h&quot;文件可以不声明该成员变量</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="co">//@synthesize height;</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="co">//如果对应的成员变量名字不同，比如使用了下划线，则可以指定访问哪个成员变量</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>@synthesize height <span class="op">=</span> _height<span class="op">;</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="co">//可以多个写一起</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="co">//@synthesize age, num, height;</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a><span class="co">//相当于Java的toString，当对象被打印时调用</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span>NSString <span class="op">*)</span>description <span class="op">{</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="op">[</span>NSString stringWithFormat<span class="op">:</span><span class="st">&quot;age: %i&quot;</span><span class="op">,</span> _age<span class="op">];</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span></code></pre></div>
<p>main.m</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;Student.h&quot;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>argv<span class="op">[])</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">//调用静态方法分配内存</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    Student <span class="op">*</span> stu1 <span class="op">=</span> <span class="op">[</span>Student alloc<span class="op">];</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">//使用默认构造函数初始化</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    stu1 <span class="op">=</span> <span class="op">[</span>stu1 init<span class="op">];</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">//以上两步可以写成一步</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">//Student * stu1 = [[Student alloc] init];</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">//相当于直接使用new，但new只能调用默认的构造函数</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">//Student * stu1 = [Student new];</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">//使用自定义构造函数</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">//Student * stu1 = [[Student alloc] initWithAge:18];</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">/*//使用autorelease可以自动释放内存，不需要手动调用release</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co">    @autoreleasepool {</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co">        Student * stu1 = [[[Student alloc] init] autorelease];</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="co">    }*/</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">//使用 [对象 方法名] 或 [类名 类方法名] 调用任意方法</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>stu1 setAge<span class="op">:</span><span class="dv">18</span><span class="op">];</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> age <span class="op">=</span> <span class="op">[</span>stu1 age<span class="op">];</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    NSLog<span class="op">(</span><span class="st">@&quot;age is %i&quot;</span><span class="op">,</span> age<span class="op">);</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>stu1 setAge<span class="op">:</span><span class="dv">19</span> andNum<span class="op">:</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    NSLog<span class="op">(</span><span class="st">@&quot;age is %i, num is %i&quot;</span><span class="op">,</span> <span class="op">[</span>stu1 age<span class="op">],</span> <span class="op">[</span>stu1 num<span class="op">]);</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">//使用点语法调用get、set方法（所以如果成员变量XXX和getXXX、setXXX一样，即不带下划线，则在get、set中不能使用self.xxx=xxx或return xxx，否则会调用自身，造成死循环）</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    stu1<span class="op">.</span>age <span class="op">=</span> <span class="dv">20</span><span class="op">;</span><span class="co">//这里是调用setAge方法，而不是访问成员变量</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    age <span class="op">=</span> stu1<span class="op">.</span>age<span class="op">;</span><span class="co">//这里是调用age方法，而不是访问成员变量</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">//如果想直接访问对象的public成员变量，可以使用&quot;-&gt;&quot;，这时不会调用get、set方法</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">//int age = stu1-&gt;age;</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">//打印一个对象，%@是对象的格式控制符</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>    NSLog<span class="op">(</span><span class="st">@&quot;%S&quot;</span><span class="op">,</span> stu1<span class="op">);</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>    <span class="co">//释放内存</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>stu1 release<span class="op">];</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="内存管理">内存管理</h3>
<p>Object-C如果使用MRC，则不支持自动垃圾回收，需要手动释放内存，如果使用的是ARC(Automatic
Reference Counting)，可以自动加上垃圾回收的代码，不需要手动管理内存</p>
<p>新建IOS项目是可以选择是否使用ARC，如果不使用则是MRC；或者点击项目，选择<code>Build Phases</code>，找到<code>Compile Source</code>中某个类的”.m”文件，点击<code>Compiler Flags</code>的位置然后在弹出的框中加上编译参数<code>-fno-objc-arc</code>，这样就指定了该类使用MRC的方式编译</p>
<p>Object-C在MRC中使用引用计数法进行内存管理： -
当使用alloc、new、mutablecopy或者copy创建一个对象时，引用计数设置为1 -
之后每给对象发送一条retain消息时，引用计数加1 -
每发送一条release消息时，引用计数减1，当引用计数为0时 -
对象所占内存会被回收，并给对象发送一条dealloc消息，释放内存一般会重写dealloc方法，并在此方法中释放相关资源；要注意的是，一定不要直接调用dealloc方法
- 可以给对象发送retainCount消息获取当前的引用计数</p>
<p>IOS中的Object-C编程有以下约定： -
如果使用alloc、new、mutablecopy或者copy创建对象，除非使用了autorelease，否则都需要手动调用release释放内存
-
只要使用类方法创建的对象，返回的都是带autorelease属性的，不需要手动管理内存
-
除了以上两种情况，还有一种情况：通过<code>@&quot;xxx&quot;</code>创建的<code>NSString *</code>，是字符串常量，不需要手动管理内存</p>
<p>知识点： - 对象用完要调用release -
复杂类型不能直接set，要调用对应的release和retain，并在dealloc时release -
复杂类型也可以通过给<code>@property</code>添加<code>(retain)</code>属性的方式，生成不会造成内存泄漏的set方法
-
“.h”文件中使用<code>@class</code>，“.m”文件中使用<code>#import</code>提高编译性能，解决解决循环导入问题；但是继承的父类不能用<code>@class</code>导入
-
<code>autorelease pool</code>，自动释放池，如果要在for循环中创建大量的临时对象，那么建议在for循环里面加上<code>@autoreleasepool</code></p>
<p>Book.h</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="kw">@interface</span> Book <span class="op">:</span> NSObject</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>@property <span class="dt">float</span> price<span class="op">;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span></code></pre></div>
<p>Book.m</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;Book.h&quot;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="kw">@implementation</span> Book</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>@synthesize price <span class="op">=</span> _price<span class="op">;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>dealloc <span class="op">{</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    NSLog<span class="op">(</span><span class="st">@&quot;Book dealloc: %@&quot;</span><span class="op">,</span> <span class="kw">self</span><span class="op">);</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">//一定要调用super的dealloc方法，而且最好放到最后</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="kw">super</span> dealloc<span class="op">];</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span></code></pre></div>
<p>Student.h</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">/* 头文件可能会重复导入，&quot;#import&quot;虽然会自动判重，但是依然会有性能损耗</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">而且如果一个类的方法声明有变，那么使用#import导入这个头文件的类都需要重新编译 */</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">//#import &quot;Book.h&quot;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">/* 使用&quot;@class&quot;把Book标记为一个类可以降低性能损耗，因为在导入头文件时不会去检查里面的方法和变量，而且这样可以解决循环导入的问题</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">如果&quot;.h&quot;文件中使用&quot;@class&quot;，那么需要在&quot;.m&quot;文件中使用#import真正导入对应的头文件，否则无法使用类中的方法</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">但是如果是继承或通过Category扩展某个类，则不能用&quot;@class&quot;，因为在声明时就要知道父类有哪些方法 */</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="kw">@class</span> Book<span class="op">;</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="kw">@interface</span> Student <span class="op">:</span> NSObject</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>@property <span class="dt">int</span> age<span class="op">;</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>@property Book <span class="op">*</span>book<span class="op">;</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co">//复杂类型也可以通过给&quot;@property&quot;添加&quot;retain&quot;属性，自动生成不会造成内存泄漏的set方法和普通的get方法（这里为了演示安全的set方法，不用这种方式）</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co">@property (retain) Book *book;</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co">与retain对应，其实默认set方式就是assign（直接赋值），assign一般用于基本数据类型，在ARC下如果复杂数据类型用assign，新建的对象没有强引用指向则立即销毁，如果后面想对其成员变量赋值，由于这时指针指向的内存地址已经被销毁了，那么就会造成野指针异常</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co">或者使用拷贝copy，需要支持copy的类型，比如NSString（防止跟随外部改变而改变）、Block（使用copy的Block才会存储在堆中，否则如果在其他方法中给Block赋值，使用assign会存储在栈中，方法执行完Block就销毁了）、NSArray等</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co">或者使用strong，强引用，一般用在NSArray、NSDate、NSNumber、模型类等，或者手动创建的直接通过set方式添加的全局UI控件中（如果使用addSubView添加到self.view中的控件，在subView中会有强引用指向，这时可以使用weak）</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="co">或者使用weak，弱引用，只有在ARC下才能使用，如果没有强引用指向则立刻销毁并指向null（如果使用了autorelease，那么在当前autoreleasepool内都有强引用指向），一般用delegate中（如果使用strong，设置self.delegate=self就会造成循环引用，无法释放内存），或在IOS中通过拖拽生成的UI控件的引用中</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="co">retain一般在MRC中使用，strong、weak只能在ARC中使用，assign、copy在MRC和ARC中都可以使用</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>@property <span class="op">(</span>assign<span class="op">)</span> <span class="dt">int</span> age<span class="op">;</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="co">//还可以指定添加get、set中的其中一个（readonly、writeonly、readwrite(默认)）</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>@property <span class="op">(</span>readonly<span class="op">)</span> <span class="dt">int</span> age<span class="op">;</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="co">//还可以指定是否具有原子性（atomic(默认)、nonatomic），如果不需要多线程，建议使用nonatomic</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>@property <span class="op">(</span>nonatomic<span class="op">)</span> <span class="dt">int</span> age<span class="op">;</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="co">//还可以指定getter、setter的名字</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>@property <span class="op">(</span>getter <span class="op">=</span> isGraduated<span class="op">,</span> setter <span class="op">=</span> setIsGraduated<span class="op">)</span> BOOL graduated<span class="op">;</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="co">//多个参数之间用逗号分隔</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>@property <span class="op">(</span>nonatomic<span class="op">,</span> assign<span class="op">)</span> <span class="dt">int</span> age<span class="op">;</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a><span class="op">*/</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a><span class="co">//提供一个和当前类名相同（首字母小写）的类方法快速创建对象</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> <span class="op">(</span>id<span class="op">)</span>student<span class="op">;</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span></code></pre></div>
<p>Student.m</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;Student.h&quot;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">//如果在&quot;.h&quot;文件里使用了@class，则在&quot;.m&quot;文件中应该导入对应的头文件，否则会找不到类中有哪些方法</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;Book.h&quot;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="kw">@implementation</span> Student</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">//这里只写set方法，get方法让&quot;@property&quot;自动生成（这里的&quot;_book&quot;也是由&quot;@property&quot;自动生成的）</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">//直接set复杂类型容易造成内存泄漏，需要调对应的retain方法</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>setBook<span class="op">:(</span>Book <span class="op">*)</span>book <span class="op">{</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="op">(</span>_book <span class="op">!=</span> book<span class="op">)</span> <span class="op">{</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">//如果_book有值，则先release原来的</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span>_book release<span class="op">];</span><span class="co">//如果_book为nil，也不会发生错误，不需要判空</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        _book <span class="op">=</span> <span class="op">[</span>book retain<span class="op">];</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co">//一般由类方法返回的对象在创建时都要autorelease</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> <span class="op">(</span>id<span class="op">)</span>student <span class="op">{</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">//考虑到继承的情况，其实这里应该使用&quot;[self class]&quot;而不是Student（后面会介绍，这里暂时使用这种方式）</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="op">[[[</span>Student alloc<span class="op">]</span> init<span class="op">]</span> autorelease<span class="op">];</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>dealloc <span class="op">{</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    NSLog<span class="op">(</span><span class="st">@&quot;Student dealloc: %@&quot;</span><span class="op">,</span> <span class="kw">self</span><span class="op">);</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">//[_book release];</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    <span class="co">//或者使用点语法调用set方法，set方法release的同时把_book置为nil</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">//如果@property加了retain属性，最好用这种方式释放内存</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">self</span><span class="op">.</span>book <span class="op">=</span> nil<span class="op">;</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">//一定要调用super的dealloc方法，而且最好放到最后</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="kw">super</span> dealloc<span class="op">];</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span></code></pre></div>
<p>main.m</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;Book.h&quot;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;Student.h&quot;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>argv<span class="op">[])</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    Student <span class="op">*</span> student1 <span class="op">=</span> <span class="op">[[</span>Student alloc<span class="op">]</span> init<span class="op">];</span><span class="co">//引用计数设置为1</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    Book <span class="op">*</span> book1 <span class="op">=</span> <span class="op">[[</span>Book alloc<span class="op">]</span> init<span class="op">];</span><span class="co">//引用计数设置为1</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>student1 retain<span class="op">];</span><span class="co">//引用计数加1，变成2</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    NSLog<span class="op">(</span><span class="st">@&quot;count: %zi&quot;</span><span class="op">,</span> <span class="op">[</span>student1 retainCount<span class="op">]);</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>student1 release<span class="op">];</span><span class="co">//引用计数减1，变成1</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    student1<span class="op">.</span>book <span class="op">=</span> book1<span class="op">;</span><span class="co">//在Student的方法中，book的引用计数加一，变成2</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>book1 release<span class="op">];</span><span class="co">//引用计数减1，变为1</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>student1 release<span class="op">];</span><span class="co">//book引用计数减1，变为0，自动发送dealloc消息；student引用计数减1，变为0，自动发送dealloc消息</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">//创建自动释放池，当自动释放池销毁时，会调用一次里面的对象的release方法</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">//由于使用自动释放池会延迟释放，不要在自动释放池中使用for循环创建大量对象，而是把自动释放池放进for循环里</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    @autoreleasepool <span class="op">{</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">//创建对象并把对象放进当前的自动释放池中</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>        Student <span class="op">*</span> student2 <span class="op">=</span> <span class="op">[[[</span>Student alloc<span class="op">]</span> init<span class="op">]</span> autorelease<span class="op">];</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>        Student <span class="op">*</span> student3 <span class="op">=</span> <span class="op">[</span>Student student<span class="op">];</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="category和extension">Category和Extension</h3>
<p>使用分类（<code>Category</code>），可以在不修改类的源文件的情况下，给类扩充方法（但不能扩充成员变量）</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------Student.h----------------</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="kw">@interface</span> Student <span class="op">:</span> NSObject</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------Student.m----------------</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;Student.h&quot;</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="kw">@implementation</span> Student</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------Student+Extra.h----------------</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;Student.h&quot;</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co">//类名后面的括号代表Category</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="kw">@interface</span> Student <span class="op">(</span>Extra<span class="op">)</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>test<span class="op">;</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------Student+Extra.m----------------</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;Student+Extra.h&quot;</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="kw">@implementation</span> Student <span class="op">(</span>Extra<span class="op">)</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>test <span class="op">{</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    NSLog<span class="op">(</span><span class="st">@&quot;扩展的方法&quot;</span><span class="op">);</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------main.m----------------</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="co">//#import &quot;Student.h&quot; 这里可以不导入，因为Student+Extra.h中已经导入过了</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;Student+Extra.h&quot;</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>argv<span class="op">[])</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>    @autoreleasepool <span class="op">{</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>        Student <span class="op">*</span> student1 <span class="op">=</span> <span class="op">[[[</span>Student alloc<span class="op">]</span> init<span class="op">]</span> autorelease<span class="op">];</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span>student1 test<span class="op">];</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>类扩展（<code>Extension</code>）和分类（<code>Category</code>）很像，但是括号中没有名称，类扩展的声明建议放在分类的”.m”文件中或者类的”.m”中（即”Student.m”或”Student+Extra.h”），而不是”.h”文件中</p>
<p>类扩展的作用： -
类扩展可以把暴露给外面的只读属性（在”.h”文件中声明的属性）改为读写（在类扩展中）方便类内部修改
- 可以添加任意私有属性、方法</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------Student.h----------------</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="kw">@interface</span> Student <span class="op">:</span> NSObject</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------Student.m----------------</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;Student.h&quot;</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">//类扩展</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="kw">@interface</span> Student <span class="op">()</span> <span class="op">{</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">//变量</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co">//方法</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>read<span class="op">();</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="kw">@implementation</span> Student</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="co">//类扩展的实现</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>read<span class="op">()</span> <span class="op">{}</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span></code></pre></div>
<h3 id="protocol">Protocol</h3>
<p>Protocol就像Java中的接口，可以在其中声明一系列的方法，声明的方法可以被任意的类实现，但是和Java不同的是，Object-C不要求全部实现，可以只实现其中一部分方法，在Object-C中，这种被称为代理模式（delegation）</p>
<p>通过<code>[对象 conformsToProtocol:protocol(协议名)]</code>可以检查某个类是否实现了某协议</p>
<p>一个类可以实现多个协议</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------Button.h----------------</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="kw">@class</span> Button<span class="op">;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">//一个Protocol要实现另一Protocol，使用尖括号，一般来说，所有协议都都要实现基本的协议NSObject</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">//如果要实现多个协议：&lt;protocol1, protocol2, ...&gt;</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="kw">@protocol</span> ButtonDelegate <span class="op">&lt;</span>NSObject<span class="op">&gt;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>onClick<span class="op">:(</span>Button <span class="op">*)</span>button<span class="op">;</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co">//Object-C中，一个类实现一个协议并不要求实现里面的所有方法，但是我们可以声明哪些方法是必须实现的，哪些是可选的，如果没有指定，则默认是&quot;@required&quot;</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co">//虽然声明了&quot;@required&quot;，但是编译器仍然不要求该方法必须实现，如果没有实现，只会给出警告，&quot;@required&quot;目前并没有实际作用</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">//要求test1、test2必须实现：</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co">@required</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co">- (void)test1;</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co">- (void)test2;</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="co">//test3、test4可以不实现</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="co">@optional</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="co">- (void)test3;</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="co">- (void)test4;</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="kw">@interface</span> Button <span class="op">:</span> NSObject</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="co">//id表示任意对象的指针，后面加尖括号表示要求该对象实现某个协议</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>@property <span class="op">(</span>nonatomic<span class="op">,</span> retain<span class="op">)</span> id<span class="op">&lt;</span>ButtonDelegate<span class="op">&gt;</span> delegate<span class="op">;</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>clickButton<span class="op">;</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------Button.m----------------</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;Button.h&quot;</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a><span class="kw">@implementation</span> Button</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>clickButton <span class="op">{</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">//由于Protocol不要求全部实现其中的方法，需要判断是否实现了该方法（注意：冒号也是方法名的一部分）</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span><span class="op">(</span> <span class="op">[</span>_deleagte respondsToSelector<span class="op">:</span><span class="kw">@selector</span><span class="op">(</span>onClick<span class="op">:)]</span> <span class="op">)</span> <span class="op">{</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span>_delegate onClick<span class="op">:</span><span class="kw">self</span><span class="op">];</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>dealloc <span class="op">{</span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">self</span><span class="op">.</span>delegate <span class="op">=</span> nil<span class="op">;</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="kw">super</span> dealloc<span class="op">];</span></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------ButtonListener.h----------------</span></span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a><span class="co">//和&quot;@class&quot;类似，这里可以使用&quot;@protocol&quot;进行标记，在&quot;.m&quot;文件中再真正导入</span></span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a><span class="co">//#import &quot;Button.h&quot;</span></span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a><span class="kw">@protocol</span> ButtonDelegate<span class="op">;</span></span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a><span class="co">//实现某个协议用尖括号</span></span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a><span class="kw">@interface</span> ButtonListener <span class="op">:</span> NSObject <span class="op">&lt;</span>ButtonDelegate<span class="op">&gt;</span></span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------ButtonListener.m----------------</span></span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;ButtonListener.h&quot;</span></span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a><span class="co">//我们把ButtonDelegate放在了Button.h里面</span></span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;Button.h&quot;</span></span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a><span class="kw">@implementation</span> ButtonListener</span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>onClick<span class="op">:(</span>Button <span class="op">*)</span>button <span class="op">{</span></span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a>    NSLog<span class="op">(</span><span class="st">@&quot;Button onClick: %@&quot;</span><span class="op">,</span> button<span class="op">);</span></span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-77"><a href="#cb23-77" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------main.m----------------</span></span>
<span id="cb23-78"><a href="#cb23-78" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb23-79"><a href="#cb23-79" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;Button.h&quot;</span></span>
<span id="cb23-80"><a href="#cb23-80" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;ButtonListener.h&quot;</span></span>
<span id="cb23-81"><a href="#cb23-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-82"><a href="#cb23-82" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>argv<span class="op">[])</span></span>
<span id="cb23-83"><a href="#cb23-83" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb23-84"><a href="#cb23-84" aria-hidden="true" tabindex="-1"></a>    @autoreleasepool <span class="op">{</span></span>
<span id="cb23-85"><a href="#cb23-85" aria-hidden="true" tabindex="-1"></a>        Button <span class="op">*</span> button <span class="op">=</span> <span class="op">[[[</span>Button alloc<span class="op">]</span> init<span class="op">]</span> autorelease<span class="op">];</span></span>
<span id="cb23-86"><a href="#cb23-86" aria-hidden="true" tabindex="-1"></a>        ButtonListener <span class="op">*</span> buttonListener <span class="op">=</span> <span class="op">[[[</span>ButtonListener alloc<span class="op">]</span> init<span class="op">]</span> autorelease<span class="op">];</span></span>
<span id="cb23-87"><a href="#cb23-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-88"><a href="#cb23-88" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span><span class="op">([</span>buttonListener conformsToProtocol<span class="op">:</span>protocol<span class="op">(</span>ButtonDelegate<span class="op">)])</span> <span class="op">{</span></span>
<span id="cb23-89"><a href="#cb23-89" aria-hidden="true" tabindex="-1"></a>            <span class="co">//xxx</span></span>
<span id="cb23-90"><a href="#cb23-90" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb23-91"><a href="#cb23-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-92"><a href="#cb23-92" aria-hidden="true" tabindex="-1"></a>        button<span class="op">.</span>delegate <span class="op">=</span> buttonListener<span class="op">;</span></span>
<span id="cb23-93"><a href="#cb23-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-94"><a href="#cb23-94" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span>button clickButton<span class="op">];</span></span>
<span id="cb23-95"><a href="#cb23-95" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-96"><a href="#cb23-96" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb23-97"><a href="#cb23-97" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="block">Block</h3>
<p>Block和Lambda表达式类似，封装了一段代码，可以当作函数参数或返回值</p>
<p>和函数指针不同，Block是inline的，而且对外部的变量只能读取，不能修改</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">//Block可以配合typedef使用</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">int</span> <span class="op">(^</span>Sum1<span class="op">)</span> <span class="op">(</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">);</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>argv<span class="op">[])</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    @autoreleasepool <span class="op">{</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        Sum1 sum1 <span class="op">=</span> <span class="op">^(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> a <span class="op">+</span> b<span class="op">;</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>        NSLog<span class="op">(</span><span class="st">@&quot;%i&quot;</span><span class="op">,</span> sum1<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">));</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">//要创建供Block修改的局部变量，需使用&quot;__block&quot;修饰</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>        __block <span class="dt">int</span> b <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="op">(^</span>Sum2<span class="op">)</span> <span class="op">(</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">)</span> <span class="op">=</span> <span class="op">^(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>            <span class="co">//a++;//错误，不能修改外部变量</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>            b<span class="op">++;</span><span class="co">//正确</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> a <span class="op">+</span> b<span class="op">;</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>        NSLog<span class="op">(</span><span class="st">@&quot;%i&quot;</span><span class="op">,</span> Sum2<span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">));</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Block的不同使用方式会存储在不同的地方</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">//全局Block __NSGlobalBlock__</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> <span class="op">(^</span>test1<span class="op">)()</span> <span class="op">=</span> <span class="op">^{</span> NSLog<span class="op">(</span><span class="st">@&quot;aaa&quot;</span><span class="op">);</span> <span class="op">};</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>NSLog<span class="op">(</span><span class="st">@&quot;%@&quot;</span><span class="op">,</span> test1<span class="op">);</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co">//栈Block（需使用MRC时） __NSStackBlock__</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> num2 <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> <span class="op">(^</span>test2<span class="op">)()</span> <span class="op">=</span> <span class="op">^{</span> NSLog<span class="op">(</span><span class="st">@&quot;aaa %d&quot;</span><span class="op">,</span> num2<span class="op">);</span> <span class="op">};</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>NSLog<span class="op">(</span><span class="st">@&quot;%@&quot;</span><span class="op">,</span> test2<span class="op">);</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co">//堆Block __NSMallocBlock__</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> num3 <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> <span class="op">(^</span>test3<span class="op">)()</span> <span class="op">=</span> <span class="op">^{</span> NSLog<span class="op">(</span><span class="st">@&quot;aaa %d&quot;</span><span class="op">,</span> num3<span class="op">);</span> <span class="op">};</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>NSLog<span class="op">(</span><span class="st">@&quot;%@&quot;</span><span class="op">,</span> <span class="op">[</span>test3 copy<span class="op">]);</span></span></code></pre></div>
<p>使用Block实现前面的ButtonDelegate：</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------Button.h----------------</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="kw">@class</span> Button</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">void</span> <span class="op">(^</span>ButtonBlock<span class="op">)</span> <span class="op">(</span>Button <span class="op">*);</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="kw">@interface</span> Button <span class="op">:</span> NSObject</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>@property <span class="op">(</span>nonatomic<span class="op">,</span> assign<span class="op">)</span> ButtonBlock listener<span class="op">;</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>clickButton<span class="op">;</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------Button.m----------------</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;Button.h&quot;</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="kw">@implementation</span> Button</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>clickButton <span class="op">{</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    _listener<span class="op">(</span><span class="kw">self</span><span class="op">);</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>dealloc <span class="op">{</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">self</span><span class="op">.</span>listener <span class="op">=</span> nil<span class="op">;</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="kw">super</span> release<span class="op">];</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------main.m----------------</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;Button.h&quot;</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>argv<span class="op">[])</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>    @autoreleasepool <span class="op">{</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>        Button <span class="op">*</span> button <span class="op">=</span> <span class="op">[[[</span>Button alloc<span class="op">]</span> init<span class="op">]</span> autorelease<span class="op">];</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>        button<span class="op">.</span>listener <span class="op">=</span> <span class="op">^(</span>Button <span class="op">*</span> button<span class="op">)</span> <span class="op">{</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>            NSLog<span class="op">(</span><span class="st">@&quot;Button click: %@&quot;</span><span class="op">,</span> button<span class="op">);</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span>button clickButton<span class="op">];</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="copy和mutablecopy">copy和mutableCopy</h3>
<p>使用copy需实现NSCopying协议，创建的是不可变副本（如NSString、NSArray、NSDictionary）</p>
<p>使用mutableCopy需实现NSMutableCopying，创建的是可变副本（如NSMutableString、NSMutableArray、NSMutableDictionary）</p>
<p>只有当不可变对象创建不可变副本（copy）时，才是浅拷贝（作一次retain，引用计数加1，指针拷贝），其余情况都是深拷贝</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>argv<span class="op">[])</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    @autoreleasepool <span class="op">{</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        NSString <span class="op">*</span> str1 <span class="op">=</span> <span class="op">[[</span>NSString alloc<span class="op">]</span> initWithFormat<span class="op">:</span><span class="st">@&quot;age is %i&quot;</span><span class="op">,</span> <span class="dv">18</span><span class="op">];</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">//无论可变/不可变类型都，只要实现了对应的协议，都可以生成一个不可变/可变类型</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>        NSMutableString <span class="op">*</span> str1MutableCopy <span class="op">=</span> <span class="op">[</span>str1 mutableCopy<span class="op">];</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>        NSString <span class="op">*</span> str1Copy <span class="op">=</span> <span class="op">[</span>str1 copy<span class="op">];</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>        NSLog<span class="op">(</span><span class="st">&quot;%i&quot;</span><span class="op">,</span> str1 <span class="op">==</span> str1MutableCopy<span class="op">);</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>        NSLog<span class="op">(</span><span class="st">&quot;%i&quot;</span><span class="op">,</span> str1 <span class="op">==</span> str1Copy<span class="op">);</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">//调用了copy或mutableCopy，都要release</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span>str1Copy release<span class="op">];</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span>str1MutableCopy release<span class="op">];</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span>str1 release<span class="op">];</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>实现NSCopying协议</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------Student.h----------------</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="kw">@interface</span> Student <span class="op">:</span> NSObject <span class="op">&lt;</span>NSCopying<span class="op">&gt;</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>@property <span class="op">(</span>nonatomic<span class="op">,</span> copy<span class="op">)</span> NSString <span class="op">*</span> name<span class="op">;</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> <span class="op">(</span>id<span class="op">)</span>studentWithName<span class="op">:(</span>NSString <span class="op">*)</span>name<span class="op">;</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------Student.m----------------</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;Student.h&quot;</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="kw">@implementation</span> Student</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> <span class="op">(</span>id<span class="op">)</span>studentWithName<span class="op">:(</span>NSString <span class="op">*)</span>name <span class="op">{</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">//如果使用&quot;[[self class] alloc]&quot;，那么子类调用该方法创建对象时得到的是子类的类型（self为子类）</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">//而如果直接&quot;[Student alloc]&quot;，那么子类得到的是当前父类的类型，父类不能转为子类，子类要返回子类的类型就无法使用该方法初始化父类属性</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    Student <span class="op">*</span> student <span class="op">=</span> <span class="op">[[[[</span><span class="kw">self</span> class<span class="op">]</span> alloc<span class="op">]</span> init<span class="op">]</span> autorelease<span class="op">];</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    student<span class="op">.</span>name <span class="op">=</span> name<span class="op">;</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> student<span class="op">;</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>dealloc <span class="op">{</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>_name release<span class="op">];</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="kw">super</span> dealloc<span class="op">];</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="co">//zone是系统划分好的用于复制的对象的存储空间</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span>id<span class="op">)</span>copyWithZone<span class="op">:(</span>NSZone <span class="op">*)</span>zone <span class="op">{</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">//和自定义的构造函数一样，考虑到当前类可能会被继承，应该使用&quot;[self class]&quot;</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">//注意这里不需要autorelease，因为我们约定在外部释放（每调一次copy都要调一次release）</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">//Student * copy = [[[self class] allocWithZone:zone] init];</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">//一般来说，是调用父类的copyWithZone方法获取</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>    Student <span class="op">*</span> copy <span class="op">=</span> <span class="op">[</span><span class="kw">super</span> copyWithZone<span class="op">:</span>zone<span class="op">];</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">//由于使用了copy策略，这里是深拷贝</span></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>    copy<span class="op">.</span>name <span class="op">=</span> <span class="kw">self</span><span class="op">.</span>name<span class="op">;</span></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> copy<span class="op">;</span></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span></code></pre></div>
<h2 id="ios开发">IOS开发</h2>
<h3 id="控件获取">控件获取</h3>
<p>控件和点击事件、控件获取都是通过拖拽的方式进行映射的，使用控件都是<code>UIView</code>的子类；如果想禁止某个控件被点击（禁止和用户交互），把该控件的<code>userInteractionEnabled</code>设置为NO即可</p>
<p>控件可以通过在<code>storyboard</code>中在列表中选中控件，打开辅助编辑器，然后按住ctrl键，把view拖到controller的类扩展中，然后在弹出的框中的connection选择outlet进行关联</p>
<h3 id="平移缩放旋转动画">平移、缩放、旋转、动画</h3>
<p>平移、缩放都是通过<code>frame</code>属性设置的</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">//btnIcon是在storyboard中按住ctrl键拖到类扩展中的成员变量</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>CGRect originFrame <span class="op">=</span> <span class="kw">self</span><span class="op">.</span>btnIcon<span class="op">.</span>frame<span class="op">;</span><span class="co">//获取原来的坐标、宽高</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">//打印</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>NSLog<span class="op">(</span><span class="st">@&quot;%@&quot;</span><span class="op">,</span> NSStringFromCGRect<span class="op">(</span>originFrame<span class="op">));</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>originFrame<span class="op">.</span>origin<span class="op">.</span>x <span class="op">+=</span> <span class="dv">10</span><span class="op">;</span><span class="co">//右移</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>originFrame<span class="op">.</span>origin<span class="op">.</span>y <span class="op">+=</span> <span class="dv">10</span><span class="op">;</span><span class="co">//下移</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>originFrame<span class="op">.</span>size<span class="op">.</span>width <span class="op">+=</span> <span class="dv">10</span><span class="op">;</span><span class="co">//宽度加10</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>originFrame<span class="op">.</span>size<span class="op">.</span>height <span class="op">+=</span> <span class="dv">10</span><span class="op">;</span><span class="co">//高度加10</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co">//或者</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co">//originFrame.size = CGSizeMake(originFrame.size.width + 10, originFrame.size.height + 10);</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="kw">self</span><span class="op">.</span>btnIcon<span class="op">.</span>frame <span class="op">=</span> originFrame<span class="op">;</span><span class="co">//再设置回去</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="co">//self.btnIcon.frame.size.width += 10;//错误，如果成员变量是一个结构体，要修改结构体中的内容，必须先获取结构体再修改</span></span></code></pre></div>
<p>除此以外，还能通过<code>center</code>和<code>bounds</code>修改，但<code>center</code>只能修改坐标，<code>bounds</code>只能修改大小</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>CGPoint centerPonit <span class="op">=</span> <span class="kw">self</span><span class="op">.</span>btnIcon<span class="op">.</span>center<span class="op">;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>centerPonit<span class="op">.</span>x <span class="op">+=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="kw">self</span><span class="op">.</span>btnIcon<span class="op">.</span>center <span class="op">=</span> centerPonit<span class="op">;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>CGRect originBounds <span class="op">=</span> <span class="kw">self</span><span class="op">.</span>btnIcon<span class="op">.</span>bounds<span class="op">;</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>originBounds<span class="op">.</span>size<span class="op">.</span>width <span class="op">+=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="kw">self</span><span class="op">.</span>btnIcon<span class="op">.</span>bounds <span class="op">=</span> originBounds<span class="op">;</span></span></code></pre></div>
<p>旋转是通过<code>transform</code>属性设置的，<code>transform</code>也能实现平移、缩放等效果</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">//直接逆时针旋转PI/4（即45°）</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="kw">self</span><span class="op">.</span>btnIcon<span class="op">.</span>transform <span class="op">=</span> CGAffineTransformMakeRotation<span class="op">(-</span>M_PI_4<span class="op">);</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">//基于原来的值再旋转45°</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>CGAffineTransform originTransform <span class="op">=</span> <span class="kw">self</span><span class="op">.</span>btnIcon<span class="op">.</span>transform<span class="op">;</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="kw">self</span><span class="op">.</span>btnIcon<span class="op">.</span>transform <span class="op">=</span> CGAffineTransformRotation<span class="op">(</span>originTransform<span class="op">,</span> <span class="op">-</span>M_PI_4<span class="op">);</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co">//transform还能实现平移、缩放等效果</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="kw">self</span><span class="op">.</span>btnIcon<span class="op">.</span>transform <span class="op">=</span> CGAffineTransformTranslate<span class="op">(</span><span class="kw">self</span><span class="op">.</span>btnIcon<span class="op">.</span>transform<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">50</span><span class="op">);</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="kw">self</span><span class="op">.</span>btnIcon<span class="op">.</span>transform <span class="op">=</span> CGAffineTransformScale<span class="op">(</span><span class="kw">self</span><span class="op">.</span>btnIcon<span class="op">.</span>transform<span class="op">,</span> <span class="fl">1.5</span><span class="op">,</span> <span class="fl">1.5</span><span class="op">);</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co">//回到初始状态（取消通过transform设置的所有效果）</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="kw">self</span><span class="op">.</span>btnIcon<span class="op">.</span>transform <span class="op">=</span> CGAffineTransformIdentity<span class="op">;</span><span class="co">//CGAffineTransformIdentity是一个常量</span></span></code></pre></div>
<p>如果想让平移、缩放、旋转变平滑，可以使用动画效果</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>UIView beginAnimations<span class="op">:</span>nil context<span class="op">:</span>nil<span class="op">];</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>UIView setAnimationDuration<span class="op">:</span><span class="fl">0.5</span><span class="op">];</span><span class="co">//单位为秒</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co">//平移、缩放、旋转等代码</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>CGPoint centerPonit <span class="op">=</span> <span class="kw">self</span><span class="op">.</span>btnIcon<span class="op">.</span>center<span class="op">;</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>centerPonit<span class="op">.</span>x <span class="op">+=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="kw">self</span><span class="op">.</span>btnIcon<span class="op">.</span>center <span class="op">=</span> centerPonit<span class="op">;</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>UIView commitAnimations<span class="op">];</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co">//动画也能使用Block开启</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>UIView animateWithDuration0<span class="fl">.5</span> animation<span class="op">:^{</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">//平移、缩放、旋转等代码</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    CGPoint centerPonit <span class="op">=</span> <span class="kw">self</span><span class="op">.</span>btnIcon<span class="op">.</span>center<span class="op">;</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    centerPonit<span class="op">.</span>x <span class="op">+=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">self</span><span class="op">.</span>btnIcon<span class="op">.</span>center <span class="op">=</span> centerPonit<span class="op">;</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="op">}];</span></span></code></pre></div>
<p>帧动画</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">//加载帧动画所需图片</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>NSMutableArray <span class="op">*</span> arrayM <span class="op">=</span> <span class="op">[</span>NSMutableArray array<span class="op">];</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">50</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    NSString <span class="op">*</span> imgName <span class="op">=</span> <span class="op">[</span>NSString  stringWithFormat<span class="op">:</span><span class="st">@&quot;img_%02d.jpg&quot;</span><span class="op">,</span> i<span class="op">];</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">//这种加载图片的方式会缓存加载过的所有图片，如果加载的图片过多，会导致内存占用过大</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">//UIImage * img = [UIImage imageNamed:imgName];</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">//这种加载图片的方式如果没有被引用，则会自动释放</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    UIImage <span class="op">*</span> img <span class="op">=</span> <span class="op">[</span>UIImage imageWithContentsOfFile<span class="op">:[[</span>NSBundel mainBundle<span class="op">]</span> pathForResource<span class="op">:</span>imgName ofType<span class="op">:</span>nil<span class="op">]];</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>array addObject<span class="op">:</span>img<span class="op">];</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co">//设置帧动画所需图片</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="kw">self</span><span class="op">.</span>imgView<span class="op">.</span>animationImages <span class="op">=</span> arrayM<span class="op">;</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co">//设置帧动画持续时间</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="kw">self</span><span class="op">.</span>imgView<span class="op">.</span>animationDuration <span class="op">=</span> <span class="kw">self</span><span class="op">.</span>imgView<span class="op">.</span>animationImages<span class="op">.</span>count <span class="op">*</span> <span class="fl">0.1</span><span class="op">;</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="co">//设置重复次数（不设置则一直重复）</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="kw">self</span><span class="op">.</span>imgView<span class="op">.</span>animationRepeatCount <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="co">//开启动画</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="kw">self</span><span class="op">.</span>imgView startAnimating<span class="op">];</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="co">//结束动画</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="co">//[self.imgView stopAnimating];</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a><span class="co">//是否正在播放动画</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="co">//[self.imgView isAnimating];</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="co">//当动画播放结束后，调用[self.imgView animationImages:nil]，清理对图片的引用，释放内存（通过performSelector可以延迟调用一个函数）</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="kw">self</span><span class="op">.</span>imgView performSelector@selector<span class="op">(</span>animationImages<span class="op">)</span> withObject<span class="op">:</span>nil afterDelay<span class="op">:</span><span class="kw">self</span><span class="op">.</span>imgView<span class="op">.</span>animationImages<span class="op">.</span>count <span class="op">*</span> <span class="fl">0.1</span><span class="op">];</span></span></code></pre></div>
<h3 id="点击事件">点击事件</h3>
<p>点击事件的绑定方式： -
在<code>storyboard</code>中在列表中选中控件，然后按住ctrl键，把控件拖到controller的类扩展中，然后在弹出的框中的connection选择action，创建函数（或者直接拖到已创建的函数上），通过拖拽方式绑定的事件，返回值类型必须是<code>IBAction</code>
-
在<code>storyboard</code>中在列表中选中控件，点击右键，在列出的事件中点击右边的加号，拖到controller的类扩展中，剩下的步骤同上
-
在已有的返回值类型是<code>IBAction</code>的函数的左边，会有一个小图标，把该小图标拖到<code>storyboard</code>中的控件列表中的对应控件即可
-
使用代码动态创建的view的事件只能通过代码进行绑定，但这时函数的返回值类型可以是<code>void</code></p>
<p>使用拖拽的方式绑定事件函数时，如果绑定过事件但函数删除了，但绑定关系还在，这时编译会报错，需在<code>storyboard</code>的控件列表中选中对应的控件，点击右键，取消勾选对应的加号</p>
<p>如果多个view都使用了同一个点击函数，可以通过给view的tag属性设置一个数字来区分是哪个触发了事件</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">//IBAction可以当作是void</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span>IBAction<span class="op">)</span>onClick<span class="op">:(</span>UIButton <span class="op">*)</span>sender <span class="op">{</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">switch</span><span class="op">(</span>sender<span class="op">.</span>tag<span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">case</span> <span class="dv">1</span><span class="op">:</span><span class="kw">break</span><span class="op">;</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">case</span> <span class="dv">2</span><span class="op">:</span><span class="kw">break</span><span class="op">;</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>        <span class="co">//...</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>父控件也可以通过tag来找子控件</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>UITextField <span class="op">*</span> txt1 <span class="op">=</span> <span class="op">(</span>UITextField <span class="op">*)[</span><span class="kw">self</span><span class="op">.</span>view viewWithTag<span class="op">:</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>txt1<span class="op">.</span>text <span class="op">=</span> <span class="st">@&quot;文字&quot;</span><span class="op">;</span></span></code></pre></div>
<h3 id="代码动态创建">代码动态创建</h3>
<h4 id="纯代码方式">纯代码方式</h4>
<p>使用代码动态创建view，注意需要在<code>viewDidLoad</code>方法之后</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>viewDidLoad <span class="op">{</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="kw">super</span> viewDidLoad<span class="op">];</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    UIButton <span class="op">*</span> button <span class="op">=</span> <span class="op">[[</span>UIButton alloc<span class="op">]</span> init<span class="op">];</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    UIImage <span class="op">*</span> imgNormal <span class="op">=</span> <span class="op">[</span>UIImage imageNamed<span class="op">:</span><span class="st">@&quot;pic_0&quot;</span><span class="op">];</span><span class="co">//图片名字不需要带后缀</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    UIImage <span class="op">*</span> imgHighlighted <span class="op">=</span> <span class="op">[</span>UIImage imageNamed<span class="op">:</span><span class="st">@&quot;pic_1&quot;</span><span class="op">];</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">//设置按钮样式</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">//按钮的文字、图片都是按状态设置的</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>button setTittle<span class="op">:</span><span class="st">@&quot;普通状态&quot;</span> forState<span class="op">:</span>UIControlStateNormal<span class="op">];</span><span class="co">//代码提示中不带星号的类型一般都是枚举</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>button setTittleColor<span class="op">:[</span>UIColor blueColor<span class="op">]</span> forState<span class="op">:</span>UIControlStateNormal<span class="op">];</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>button setBackgroundImage<span class="op">:</span>imgNormal forState<span class="op">:</span>UIControlStateNormal<span class="op">];</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>button setTittle<span class="op">:</span><span class="st">@&quot;高亮状态&quot;</span> forState<span class="op">:</span>UIControlStateHighlighted<span class="op">];</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>button setTittleColor<span class="op">:[</span>UIColor redColor<span class="op">]</span> forState<span class="op">:</span>UIControlStateHighlighted<span class="op">];</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>button setBackgroundImage<span class="op">:</span>imgHighlighted forState<span class="op">:</span>UIControlStateHighlighted<span class="op">];</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">//设置位置、宽高</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    button<span class="op">.</span>frame <span class="op">=</span> CGRectMake<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">50</span><span class="op">);</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">//设置点击事件</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>button addTarget<span class="op">:</span><span class="kw">self</span> action<span class="op">:</span>@seletor<span class="op">(</span>onClick<span class="op">)</span> forControlEvents<span class="op">:</span>UIControlEventTouchUpInside<span class="op">];</span><span class="co">//点击时调用当前controller的onClick方法</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="kw">self</span><span class="op">.</span>view addSubview<span class="op">:</span>button<span class="op">];</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* 补充：</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="co">    [button removeFromSuperview];//把子控件从父控件中删除</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="co">    self.view.subviews;//获取子控件</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a><span class="co">    self.view.superview;//获取父控件</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a><span class="co">    */</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a><span class="co">//如果是通过拖拽方式绑定的事件，返回值类型必须是IBAction，如果是代码绑定的事件，返回值类型可以是void</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>onClick <span class="op">{</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">//...</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h4 id="加载xib文件方式">加载xib文件方式</h4>
<p><code>storyboard</code>是用来描述一个或多个个界面及界面之间的跳转关系的文件格式，而<code>xib</code>是用来描述页面中的某部分或某几个部分内容的，我们可以把某个控件在<code>xib</code>文件中做好，然后通过代码加载该控件</p>
<p><code>xib</code>经过编译、加密后，在手机上后缀变为<code>nib</code>文件</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">//找到应用程序安装到手机上的根目录</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>NSBundle <span class="op">*</span> mainBundle <span class="op">=</span> <span class="op">[</span>NSBundle mainBundle<span class="op">];</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">//在根目录下搜索nib文件并加载，由于xib中可以存放多个控件，所以返回的是一个数组</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>NSArray <span class="op">*</span> array <span class="op">=</span> <span class="op">[</span>mainBundle loadNibNamed<span class="op">:</span><span class="st">@&quot;myXibFile&quot;</span> owner<span class="op">:</span>nil options<span class="op">:</span>nil<span class="op">];</span><span class="co">//名字不需要写后缀名</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>UIView <span class="op">*</span> view <span class="op">=</span> <span class="op">[</span>array lastObject<span class="op">];</span><span class="co">//当xib中只有一个控件时可以这样获取</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co">//要获取view中的控件，可以给里面的控件设置tag，然后[view viewWithTag:xxx]获取，但是不推荐这种做法，因为一旦tag值改了，所有用该控件的地方都要改</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co">//建议新建一个类，继承自UIView，然后在&quot;xib&quot;文件中设置class为自定义的那个类，然后用拖拽的方式把控件关联到类的成员变量中（建议在&quot;.m&quot;文件的类扩展中，然后在&quot;.h&quot;文件中提供设置控件内容的方法）</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co">MyUIView * myView = [array lastObject];</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co">//myView.txt1.text = @&quot;xxx&quot;;//这里最好由自定义的类提供设置的方法，否则控件的其他属性会有被更改的风险</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span></code></pre></div>
<h4 id="加载配置文件">加载配置文件</h4>
<p><code>plist</code>全称是<code>property list</code>，类似window下的<code>ini</code>文件，是用于存储配置的，只不过<code>plist</code>存储的格式是xml</p>
<p>一般会把<code>plist</code>文件放在源码中的<code>Supporting Files</code>文件夹</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="kw">@interface</span> ViewController <span class="op">()</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>@property <span class="op">(</span>nonatomatic<span class="op">,</span> strong<span class="op">)</span> NSArray <span class="op">*</span> array<span class="op">;</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="kw">@implementation</span> ViewController</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">//重写get方法，这样可以实现懒加载</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span>NSArray <span class="op">*)</span>array <span class="op">{</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span><span class="op">(</span>_array <span class="op">==</span> nil<span class="op">)</span> <span class="op">{</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">//[NSBundle mainBundle]指app安装到手机上时的根目录</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">//然后在根目录下搜索xxx.plist文件并返回其路径</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>        NSString <span class="op">*</span> path <span class="op">=</span> <span class="op">[[</span>NSBundle mainBundle<span class="op">]</span> pathForResource<span class="op">:</span><span class="st">@&quot;xxx&quot;</span> ofType<span class="op">:</span><span class="st">@&quot;plist&quot;</span><span class="op">];</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>        <span class="co">//或者</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">//NSString * path = [[NSBundle mainBundle] pathForResource:@&quot;xxx.plist&quot; ofType:nil];</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">//读取文件（根据plist存储内容的不同，调用不同的读取方法）</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>        NSArray <span class="op">*</span> array <span class="op">=</span> <span class="op">[</span>NSArray arrayWithContentsOfFile<span class="op">:</span>path<span class="op">];</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> _array<span class="op">;</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">//...</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span></code></pre></div>
<h3 id="常用控件">常用控件</h3>
<h4 id="uiscrollview">UIScrollView</h4>
<ul>
<li><p>实现滚动效果：在<code>StoryBoard</code>中拖一个<code>UIScrollView</code>，再往<code>UIScrollView</code>中拖一个控件，然后在代码中设置<code>UIScrollView</code>的<code>contentSize</code>（如果希望某个方向不滚动，可以设置<code>contentSize</code>的该方向的值为0），如果要有偏移，可以设置<code>contentOffset</code>，内边距可以通过<code>contentInset</code>（通过<code>UIEdgeInsetsMake</code>创建）设置，可以通过<code>bounces</code>设置是否需要弹簧效果，可以通过<code>showHorizontalScrollIndicator</code>设置是否需要水平滚动条（垂直同理）</p></li>
<li><p>实现缩放效果：在<code>StoryBoard</code>中拖一个<code>UIScrollView</code>，再往<code>UIScrollView</code>中拖一个控件，然后通过实现<code>UIScrollViewDelegate</code>协议监听缩放事件（滚动事件也可以通过该代理监听），在<code>viewForZoomingInScrollView</code>中返回<code>UIScrollView</code>的某个子控件，告诉<code>UIScrollView</code>对这个控件进行缩放，可以通过<code>maximumZoomScale</code>和<code>minimumZoomScale</code>设置最大和最小缩放比</p></li>
</ul>
<p>使用<code>UIScrollView</code>实现轮播图</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;ViewController.h&quot;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="kw">@interface</span> ViewController <span class="op">()</span> <span class="op">&lt;</span>UIScrollViewDelegate<span class="op">&gt;</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>@property <span class="op">(</span>weak<span class="op">,</span> nonatomatic<span class="op">)</span> IBOutlet UIScrollview <span class="op">*</span> scrollView<span class="op">;</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>@property <span class="op">(</span>weak<span class="op">,</span> nonatomatic<span class="op">)</span> IBOutlet UIPageControl <span class="op">*</span> pageControl<span class="op">;</span><span class="co">//分页指示器，注意在storyboard中要与ScrollView同级，而不是直接拖到里面</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>@property <span class="op">(</span>nonatomatic<span class="op">,</span> strong<span class="op">)</span> NSTimer <span class="op">*</span> timer<span class="op">;</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="kw">@implementation</span> ViewController</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>viewDidLoad <span class="op">{</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="kw">super</span> viewDidLoad<span class="op">];</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">//添加图片</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    CGFloat imgW <span class="op">=</span> <span class="dv">300</span><span class="op">;</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    CGFloat imgH <span class="op">=</span> <span class="dv">130</span><span class="op">;</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    CGFloat imgY <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">5</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>        UIImage <span class="op">*</span> imgView <span class="op">=</span> <span class="op">[[</span>UIImage alloc<span class="op">]</span> init<span class="op">];</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>        NSString <span class="op">*</span> imgName <span class="op">=</span> <span class="op">[</span>NSString stringWithFormat<span class="op">:</span><span class="st">@&quot;img_%02d&quot;</span><span class="op">,</span> i<span class="op">];</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>        imgView<span class="op">.</span>image <span class="op">=</span> <span class="op">[</span>UIImage imageNamed<span class="op">:</span>imgName<span class="op">];</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>        CGFloat imgX <span class="op">=</span> i <span class="op">*</span> imgW<span class="op">;</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>        imgView<span class="op">.</span>frame <span class="op">=</span> CGRectMake<span class="op">(</span>imgX<span class="op">,</span> imgY<span class="op">,</span> imgW<span class="op">,</span> imgH<span class="op">);</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span><span class="kw">self</span><span class="op">.</span>scrollView addSubView<span class="op">:</span>imgView<span class="op">];</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">//设置内容大小</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>    CGFloat maxW <span class="op">=</span> <span class="kw">self</span><span class="op">.</span>scrollView<span class="op">.</span>frame<span class="op">.</span>size<span class="op">.</span>width <span class="op">*</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">self</span><span class="op">.</span>scrollView<span class="op">.</span>contentSize <span class="op">=</span> CGSizeMake<span class="op">(</span>maxW<span class="op">,</span> <span class="dv">0</span><span class="op">);</span><span class="co">//不滚动的方向设置为0即可</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">//实现分页（按照当前UIScrollView的大小为一页），当滑动不足一页会回弹</span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">self</span><span class="op">.</span>scrollView<span class="op">.</span>pagingEnabled <span class="op">=</span> YES<span class="op">;</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">//隐藏水平滚动条</span></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">self</span><span class="op">.</span>scrollView<span class="op">.</span>showHorizontalScrollIndicator <span class="op">=</span> NO<span class="op">;</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">//使用Delegate监听滚动事件</span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">self</span><span class="op">.</span>scrollView<span class="op">.</span>delegate <span class="op">=</span> <span class="kw">self</span><span class="op">;</span></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">//设置分页指示器</span></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">self</span><span class="op">.</span>pageControl<span class="op">.</span>numberOfPages <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">self</span><span class="op">.</span>pageControl<span class="op">.</span>currentPage <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="kw">self</span><span class="op">.</span>srollView bringSubviewToFront<span class="op">:</span><span class="kw">self</span><span class="op">.</span>pageControl<span class="op">];</span></span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>    <span class="co">//使用NSTimer实现自动滚动，适用于时间间隔较大（比如单位为秒）</span></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">self</span><span class="op">.</span>timer <span class="op">=</span> <span class="op">[</span>NSTimer scheduledTimerWithTimeInterval<span class="op">:</span><span class="fl">0.5</span> target<span class="op">:</span><span class="kw">self</span> selector<span class="op">:</span><span class="kw">@selector</span><span class="op">(</span>scrollImage<span class="op">)</span> userInfo<span class="op">:</span>nil repeats<span class="op">:</span>YES<span class="op">];</span></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">/*</span></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a><span class="co">    如果页面中任意一个scrollview在被拖动，则由Timer实现的自动滚动会暂停</span></span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a><span class="co">    这时因为只有当输入事件（Timer也是一种输入事件）的模式和当前线程的消息循环的模式一致时，输入事件才会被执行，如果页面中任意一个scrollview在被拖动，那么当前线程的消息循环模式就由NSDefaultRunLoopMode变成UITrackingRunLoopMode，导致Timer不会被执行</span></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a><span class="co">    为了避免这种情况，需要把Timer的模式设置为NSRunLoopCommonModes</span></span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a><span class="co">    */</span></span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>    NSRunLoop <span class="op">*</span> runLoop <span class="op">=</span> <span class="op">[</span>NSRunLoop currentRunLoop<span class="op">];</span></span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>runLoop addTimer<span class="op">:</span><span class="kw">self</span><span class="op">.</span>timer forMode<span class="op">:</span>NSRunLoopCommonModes<span class="op">];</span><span class="co">//NSDefaultRunLoopMode：默认的消息循环模式 NSRunLoopCommonModes：是一系列模式的集合，包含UITrackingRunLoopMode</span></span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>    <span class="co">/*</span></span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a><span class="co">    //使用CADisplayLink实现自动滚动，适用于时间间隔较小（如果屏幕刷新率是60Hz，那么CADisplayLink每秒执行60次，即与显示器刷新频率一致）</span></span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a><span class="co">    displayLink = [CADisplayLink displayLinkWithTarget:self selector:@selector(scrollImage)];</span></span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a><span class="co">    [displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];</span></span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a><span class="co">    [displayLink invalidate];//使用完毕后要释放</span></span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a><span class="co">    displayLink = nil;</span></span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a><span class="co">    */</span></span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a><span class="co">//让分页指示器跟随scrollView的滑动而滚动</span></span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>scrollViewDidScroll<span class="op">:(</span>UIScrollView <span class="op">*)</span>scrollView <span class="op">{</span></span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> page <span class="op">=</span> <span class="op">(</span>scrollView<span class="op">.</span>contentOffset<span class="op">.</span>x <span class="op">+</span> scrollView<span class="op">.</span>frame<span class="op">.</span>size<span class="op">.</span>width <span class="op">*</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">/</span> scrollView<span class="op">.</span>frame<span class="op">.</span>size<span class="op">.</span>width<span class="op">;</span></span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a>    <span class="kw">self</span><span class="op">.</span>pageControl<span class="op">.</span>currentPage <span class="op">=</span> page<span class="op">;</span></span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a><span class="co">//如果用户拖拽，则暂停自动滚动</span></span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>scrollViewWillBeginDragging<span class="op">:(</span>UIScrollView <span class="op">*)</span>scrollView <span class="op">{</span></span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a>    <span class="co">//一旦invalidate，下次使用就必须重新创建</span></span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="kw">self</span><span class="op">.</span>timer invalidate<span class="op">];</span></span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a>    <span class="kw">self</span><span class="op">.</span>timer <span class="op">=</span> nil<span class="op">;</span></span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true" tabindex="-1"></a><span class="co">//如果用户停止拖拽，继续自动播放</span></span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>scrollViewDidEndDragging<span class="op">:(</span>UIScrollView <span class="op">*)</span>scrollView willDecelerate<span class="op">:(</span>BOOL<span class="op">)</span>decelerate <span class="op">{</span></span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a>    <span class="kw">self</span><span class="op">.</span>timer <span class="op">=</span> <span class="op">[</span>NSTimer scheduledTimerWithTimeInterval<span class="op">:</span><span class="fl">0.5</span> target<span class="op">:</span><span class="kw">self</span> selector<span class="op">:</span><span class="kw">@selector</span><span class="op">(</span>scrollImage<span class="op">)</span> userInfo<span class="op">:</span>nil repeats<span class="op">:</span>YES<span class="op">];</span></span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true" tabindex="-1"></a>    NSRunLoop <span class="op">*</span> runLoop <span class="op">=</span> <span class="op">[</span>NSRunLoop currentRunLoop<span class="op">];</span></span>
<span id="cb39-85"><a href="#cb39-85" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>runLoop addTimer<span class="op">:</span><span class="kw">self</span><span class="op">.</span>timer forMode<span class="op">:</span>NSRunLoopCommonModes<span class="op">];</span></span>
<span id="cb39-86"><a href="#cb39-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-87"><a href="#cb39-87" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb39-88"><a href="#cb39-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-89"><a href="#cb39-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-90"><a href="#cb39-90" aria-hidden="true" tabindex="-1"></a><span class="co">//Timer执行的方法</span></span>
<span id="cb39-91"><a href="#cb39-91" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>scrollImage <span class="op">{</span></span>
<span id="cb39-92"><a href="#cb39-92" aria-hidden="true" tabindex="-1"></a>    NSInteger page <span class="op">=</span> <span class="kw">self</span><span class="op">.</span>pageControl<span class="op">.</span>currentPage<span class="op">;</span></span>
<span id="cb39-93"><a href="#cb39-93" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span><span class="op">(</span>page <span class="op">==</span> <span class="kw">self</span><span class="op">.</span>pageControl<span class="op">.</span>numberOfPages <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb39-94"><a href="#cb39-94" aria-hidden="true" tabindex="-1"></a>        page <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb39-95"><a href="#cb39-95" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span id="cb39-96"><a href="#cb39-96" aria-hidden="true" tabindex="-1"></a>        page<span class="op">++;</span></span>
<span id="cb39-97"><a href="#cb39-97" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb39-98"><a href="#cb39-98" aria-hidden="true" tabindex="-1"></a>    CGFloat offsetX <span class="op">=</span> page <span class="op">*</span> <span class="kw">self</span><span class="op">.</span>scrollView<span class="op">.</span>frame<span class="op">.</span>size<span class="op">.</span>width<span class="op">;</span></span>
<span id="cb39-99"><a href="#cb39-99" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="kw">self</span><span class="op">.</span>scrollView setContentOffset<span class="op">:</span>CGPointMake<span class="op">(</span>offsetX<span class="op">,</span> <span class="dv">0</span><span class="op">)</span> animated<span class="op">:</span>YES<span class="op">];</span></span>
<span id="cb39-100"><a href="#cb39-100" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb39-101"><a href="#cb39-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-102"><a href="#cb39-102" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span></code></pre></div>
<h4 id="uitableview">UITableView</h4>
<p><code>UITableView</code>是<code>UIScrollview</code>的子类，用于显示列表，它有两种样式，一种是不分组的<code>UITableViewStylePlain</code>，一种是分组的<code>UITableViewStyleGrouped</code></p>
<p>要显示数据，需设置<code>dataSource</code>，设置的<code>dataSource</code>必须遵循<code>UITableViewDataSource</code>协议（设置<code>dataSource</code>可以通过代码，也可以通过拖拽）</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;ViewController.h&quot;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="kw">@interface</span> ViewController <span class="op">()</span> <span class="op">&lt;</span>UITableViewDataSource<span class="op">,</span> UITableViewDelegate<span class="op">&gt;</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>@property <span class="op">(</span>weak<span class="op">,</span> nonatomatic<span class="op">)</span> IBOutlet UITableView <span class="op">*</span> tableView<span class="op">;</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="kw">@implementation</span> ViewController</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co">//隐藏状态栏</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span>BOOL<span class="op">)</span>prefersStatusBarHidden <span class="op">{</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> YES<span class="op">;</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>viewDidLoad <span class="op">{</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="kw">super</span> viewDidLoad<span class="op">];</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">//设置数据源</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">self</span><span class="op">.</span>tableView<span class="op">.</span>dataSource <span class="op">=</span> <span class="kw">self</span><span class="op">;</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">//设置其他样式属性</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">//self.tableView.rowHeight = 60;//如果每行行高不一样，需要通过UITableViewDelegate代理的heightForRowAtIndexPath方法来设置</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">/*</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="co">    //分割线</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a><span class="co">    self.tableView.separatorColor = [UIColor redColor];</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a><span class="co">    self.tableView.separatorStyle = UITableViewCellSeparatorStyleNone;//没有分割线</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a><span class="co">    */</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">/*</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a><span class="co">    //header、footer</span></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a><span class="co">    self.tableView.headerView = xxx;</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="co">    self.tableView.FooterView = xxx;</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a><span class="co">    */</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a><span class="co">//设置行高</span></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span>CGFloat<span class="op">)</span>tableView<span class="op">:(</span>UITableView <span class="op">*)</span>tableView heightForRowAtIndexPath<span class="op">:(</span>NSIndexPath<span class="op">)</span>indexPath <span class="op">{</span></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span><span class="op">(</span>indexPath<span class="op">.</span>row <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="dv">50</span><span class="op">;</span></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="dv">70</span><span class="op">;</span></span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------UITableView的数据源方法----------------</span></span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a><span class="co">//可选的方法，告诉UITableView分几组（如果要分组显示，需要在&quot;storyboard&quot;中把Style属性设置为Grouped；如果设置为默认的Plain，但设置了每组的标题，也可以变成用标题分隔）</span></span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span>NSInteger<span class="op">)</span>numberOfSectionsInTableView<span class="op">:(</span>UITableView <span class="op">*)</span>tableView <span class="op">{</span></span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a><span class="co">//可选的方法，告诉UITableView每组的标题显示什么（如果把Style属性设置为Plain，可以实现类似与联系人列表的首字母的样式，并且有StickyHeader的效果）</span></span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span>NSString <span class="op">*)</span>tableView<span class="op">:(</span>UITableView <span class="op">*)</span>tableView titleForHeaderInSection<span class="op">:(</span>NSInteger<span class="op">)</span>section <span class="op">{</span></span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span><span class="op">(</span>section <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="st">@&quot;亚洲&quot;</span><span class="op">;</span></span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span>section <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="st">@&quot;非洲&quot;</span><span class="op">;</span></span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span>section <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="st">@&quot;欧洲&quot;</span><span class="op">;</span></span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a><span class="co">//可选的方法，告诉UITableView每组的结尾显示什么</span></span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span>NSString <span class="op">*)</span>tableView<span class="op">:(</span>UITableView <span class="op">*)</span>tableView titleForFooterInSection<span class="op">:(</span>NSInteger<span class="op">)</span>section <span class="op">{</span></span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span><span class="op">(</span>section <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="st">@&quot;Asia&quot;</span><span class="op">;</span></span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span>section <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="st">@&quot;Africa&quot;</span><span class="op">;</span></span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span>section <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="st">@&quot;Europe&quot;</span><span class="op">;</span></span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a><span class="co">//必须实现的方法，告诉UITableView每组有几行</span></span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span>NSInteger<span class="op">)</span>tableView<span class="op">:(</span>UITableView <span class="op">*)</span>tableView numberOfRowsInSection<span class="op">:(</span>NSInteger<span class="op">)</span>section <span class="op">{</span></span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span><span class="op">(</span>section <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb40-75"><a href="#cb40-75" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span>section <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-76"><a href="#cb40-76" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb40-77"><a href="#cb40-77" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span>section <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-78"><a href="#cb40-78" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb40-79"><a href="#cb40-79" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb40-80"><a href="#cb40-80" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb40-81"><a href="#cb40-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-82"><a href="#cb40-82" aria-hidden="true" tabindex="-1"></a><span class="co">//必须实现的方法，告诉UITableView每组的每行显示什么内容</span></span>
<span id="cb40-83"><a href="#cb40-83" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span>UITableViewCell <span class="op">*)</span>tableView<span class="op">:(</span>UITableView <span class="op">*)</span>tableView cellForRowAtIndexPath<span class="op">:(</span>NSIndexPath <span class="op">*)</span>indexPath <span class="op">{</span></span>
<span id="cb40-84"><a href="#cb40-84" aria-hidden="true" tabindex="-1"></a>    UITableViewCell <span class="op">*</span> cell <span class="op">=</span> <span class="op">[[</span>UITableViewCell alloc<span class="op">]</span> initWithStyle<span class="op">:</span>UITableViewCellStyleDefault reuseIndentifier<span class="op">:</span>nil<span class="op">];</span></span>
<span id="cb40-85"><a href="#cb40-85" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span><span class="op">(</span>indexPath<span class="op">.</span>section <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-86"><a href="#cb40-86" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span><span class="op">(</span>indexPath<span class="op">.</span>row <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-87"><a href="#cb40-87" aria-hidden="true" tabindex="-1"></a>            cell <span class="op">=</span> <span class="op">[[</span>UITableViewCell alloc<span class="op">]</span> initWithStyle<span class="op">:</span>UITableViewCellStyleSubTitle reuseIndentifier<span class="op">:</span>nil<span class="op">];</span></span>
<span id="cb40-88"><a href="#cb40-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-89"><a href="#cb40-89" aria-hidden="true" tabindex="-1"></a>            cell<span class="op">.</span>imageView<span class="op">.</span>image <span class="op">=</span> <span class="op">[</span>UIImage imageNamed<span class="op">:</span><span class="st">@&quot;pic_0&quot;</span><span class="op">];</span><span class="co">//左边的图片</span></span>
<span id="cb40-90"><a href="#cb40-90" aria-hidden="true" tabindex="-1"></a>            cell<span class="op">.</span>textLabel<span class="op">.</span>text <span class="op">=</span> <span class="st">@&quot;中国&quot;</span><span class="op">;</span><span class="co">//标题</span></span>
<span id="cb40-91"><a href="#cb40-91" aria-hidden="true" tabindex="-1"></a>            cell<span class="op">.</span>defaultTextLabel<span class="op">.</span>text <span class="op">=</span> <span class="st">@&quot;content0&quot;</span><span class="op">;</span><span class="co">//详细内容，需要把style设置为UITableViewCellStyleSubTitle（或者其他非默认的类型）才会显示</span></span>
<span id="cb40-92"><a href="#cb40-92" aria-hidden="true" tabindex="-1"></a>            cell<span class="op">.</span>accessoryType <span class="op">=</span> UITableViewCellAccessoryDisclosureIndicator<span class="op">;</span><span class="co">//右边的图标样式（只能使用系统提供的图标样式）</span></span>
<span id="cb40-93"><a href="#cb40-93" aria-hidden="true" tabindex="-1"></a>            <span class="co">//cell.accessoryView = xxx;//如果系统提供的图标样式不能满足需求，也可以设置自己的view</span></span>
<span id="cb40-94"><a href="#cb40-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-95"><a href="#cb40-95" aria-hidden="true" tabindex="-1"></a>            <span class="co">/*</span></span>
<span id="cb40-96"><a href="#cb40-96" aria-hidden="true" tabindex="-1"></a><span class="co">            //背景、选中时的背景</span></span>
<span id="cb40-97"><a href="#cb40-97" aria-hidden="true" tabindex="-1"></a><span class="co">            cell.backgroundView = xxx;</span></span>
<span id="cb40-98"><a href="#cb40-98" aria-hidden="true" tabindex="-1"></a><span class="co">            cell.selectedBackgroundView = xxx;</span></span>
<span id="cb40-99"><a href="#cb40-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-100"><a href="#cb40-100" aria-hidden="true" tabindex="-1"></a><span class="co">            cell.backgroundColor = [UIColor redColor];</span></span>
<span id="cb40-101"><a href="#cb40-101" aria-hidden="true" tabindex="-1"></a><span class="co">            //设置选中时的背景色</span></span>
<span id="cb40-102"><a href="#cb40-102" aria-hidden="true" tabindex="-1"></a><span class="co">            UIView * bgView = [[UIView alloc] init];</span></span>
<span id="cb40-103"><a href="#cb40-103" aria-hidden="true" tabindex="-1"></a><span class="co">            bgView.backgroundColor = [UIColor greenColor];</span></span>
<span id="cb40-104"><a href="#cb40-104" aria-hidden="true" tabindex="-1"></a><span class="co">            cell.selectedBackgroundView = bgView;</span></span>
<span id="cb40-105"><a href="#cb40-105" aria-hidden="true" tabindex="-1"></a><span class="co">            */</span></span>
<span id="cb40-106"><a href="#cb40-106" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span>indexPath<span class="op">.</span>row <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-107"><a href="#cb40-107" aria-hidden="true" tabindex="-1"></a>            cell<span class="op">.</span>textLabel<span class="op">.</span>text <span class="op">=</span> <span class="st">@&quot;日本&quot;</span><span class="op">;</span></span>
<span id="cb40-108"><a href="#cb40-108" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span>indexPath<span class="op">.</span>row <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-109"><a href="#cb40-109" aria-hidden="true" tabindex="-1"></a>            cell<span class="op">.</span>textLabel<span class="op">.</span>text <span class="op">=</span> <span class="st">@&quot;韩国&quot;</span><span class="op">;</span></span>
<span id="cb40-110"><a href="#cb40-110" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb40-111"><a href="#cb40-111" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span>indexPath<span class="op">.</span>section <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-112"><a href="#cb40-112" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span><span class="op">(</span>indexPath<span class="op">.</span>row <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-113"><a href="#cb40-113" aria-hidden="true" tabindex="-1"></a>            cell<span class="op">.</span>textLabel<span class="op">.</span>text <span class="op">=</span> <span class="st">@&quot;南非&quot;</span><span class="op">;</span></span>
<span id="cb40-114"><a href="#cb40-114" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span>indexPath<span class="op">.</span>row <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-115"><a href="#cb40-115" aria-hidden="true" tabindex="-1"></a>            cell<span class="op">.</span>textLabel<span class="op">.</span>text <span class="op">=</span> <span class="st">@&quot;索马里&quot;</span><span class="op">;</span></span>
<span id="cb40-116"><a href="#cb40-116" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb40-117"><a href="#cb40-117" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span>indexPath<span class="op">.</span>section <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-118"><a href="#cb40-118" aria-hidden="true" tabindex="-1"></a>        cell<span class="op">.</span>textLabel<span class="op">.</span>text <span class="op">=</span> <span class="st">@&quot;荷兰&quot;</span><span class="op">;</span></span>
<span id="cb40-119"><a href="#cb40-119" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb40-120"><a href="#cb40-120" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> cell<span class="op">;</span></span>
<span id="cb40-121"><a href="#cb40-121" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb40-122"><a href="#cb40-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-123"><a href="#cb40-123" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span></code></pre></div>
<p>和Android的<code>ListView</code>一样，假设每页显示n条数据，UITableView一开始只会调用n次<code>cellForRowAtIndexPath</code>方法，创建n个cell，然后每次滚动再调用<code>cellForRowAtIndexPath</code>动态获取cell</p>
<p>如果每次都在<code>cellForRowAtIndexPath</code>中新建cell，会导致内存占用越来越大，所以需要把这n个cell放进缓存池中，每次调用<code>cellForRowAtIndexPath</code>时再从缓冲池中获取cell并更改数据，这样每种样式的cell只需创建n+1个即可</p>
<p>为了支持在有多种cell样式的情况下缓存，对于同种样式的cell，需打上同一个重用标记</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;ViewController.h&quot;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="kw">@interface</span> ViewController <span class="op">()</span> <span class="op">&lt;</span>UITableViewDataSource<span class="op">&gt;</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>@property <span class="op">(</span>weak<span class="op">,</span> nonatomatic<span class="op">)</span> IBOutlet UITableView <span class="op">*</span> tableView<span class="op">;</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="kw">@implementation</span> ViewController</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>viewDidLoad <span class="op">{</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="kw">super</span> viewDidLoad<span class="op">];</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">//设置数据源</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">self</span><span class="op">.</span>tableView<span class="op">.</span>dataSource <span class="op">=</span> <span class="kw">self</span><span class="op">;</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span>NSInteger<span class="op">)</span>numberOfSectionsInTableView<span class="op">:(</span>UITableView <span class="op">*)</span>tableView <span class="op">{</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span>NSInteger<span class="op">)</span>tableView<span class="op">:(</span>UITableView <span class="op">*)</span>tableView numberOfRowsInSection<span class="op">:(</span>NSInteger<span class="op">)</span>section <span class="op">{</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="dv">20</span><span class="op">;</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span>UITableViewCell <span class="op">*)</span>tableView<span class="op">:(</span>UITableView <span class="op">*)</span>tableView cellForRowAtIndexPath<span class="op">:(</span>NSIndexPath <span class="op">*)</span>indexPath <span class="op">{</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">//重用标记，最好使用static，避免每次都创建一次</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>    <span class="dt">static</span> NSString <span class="op">*</span> typeId <span class="op">=</span> <span class="st">@&quot;cell_type_0&quot;</span><span class="op">;</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">//先尝试根据重用标记查找</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>    UITableViewCell <span class="op">*</span> cell <span class="op">=</span> <span class="op">[</span>tableView dequeueReusableCellWithIdentifier<span class="op">:</span>typeId<span class="op">];</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">//如果找不到则创建</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span><span class="op">(!</span>cell<span class="op">)</span> <span class="op">{</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>        <span class="co">//设置reuseIndentifier，然后tableView会自动安装typeId把cell放进缓冲池中</span></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>        UITableViewCell <span class="op">*</span> cell <span class="op">=</span> <span class="op">[[</span>UITableViewCell alloc<span class="op">]</span> initWithStyle<span class="op">:</span>UITableViewCellStyleDefault reuseIndentifier<span class="op">:</span>typeId<span class="op">];</span></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">//更新数据</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>    cell<span class="op">.</span>textLabel<span class="op">.</span>text <span class="op">=</span> <span class="st">@&quot;title&quot;</span><span class="op">;</span></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> cell<span class="op">;</span></span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span></code></pre></div>
<h3 id="应用图标和启动图">应用图标和启动图</h3>
<p>在IOS中，不同型号的屏幕的尺寸不一样，即便是同尺寸的屏幕像素也可能不一样，为方便制作图标，IOS把同尺寸的屏幕划分相同数量的点</p>
<p>在开发中，使用的单位是点，而不是像素</p>
<p>比如<code>IPhone 3GS</code>和<code>IPhone 4S</code>，屏幕都是3.5英寸，所以都划分为<code>320*480</code>个点，但由于<code>IPhone 4S</code>是Retina屏幕，一个点包含<code>2*2</code>个像素（像素为<code>640*960</code>），而<code>IPhone 3GS</code>一个点只包含一个像素（像素为<code>320*480</code>），这样为了区分同大小屏幕下不同像素的图标，图标的文件命名方式为<code>xxx.png</code>和<code>xxx@2x.png</code>，比如<code>IPhone 6plus</code>，划分为<code>414*736</code>个点，像素为<code>1242*2208</code>，此时一个点包含<code>3*3</code>个像素，此时图标命名为<code>xxx@3x.png</code>，除了图标以外，应用中用到的图片资源也遵循这个命名规范</p>
<p>设置应用图标的方式：找到<code>images.xcassets</code>文件夹，选中<code>AppIcon</code>，然后把图标的图片文件从<code>Finder</code>中拖进去即可（为适配不同手机，图标可能有很多张，比如<code>AppIcon29x29.png</code>、<code>AppIcon29x29@2x.png</code>、<code>AppIcon29x29@3x.png</code>，一般包含的尺寸有<code>29x29</code>、<code>40x40</code>、<code>57x57</code>、<code>60x60</code>）</p>
<p>设置启动图的方式1：选中项目，在设置中找到<code>App Icons and Launch Images</code>中的<code>Launch Images Source</code>，原来是<code>Use Asset Catalog</code>，点击然后在弹出的框中点击<code>Migrate</code>，然后会变为<code>LaunchImage</code>，然后删掉<code>Launch Screen File</code>中的内容，此时再找到<code>images.xcassets</code>文件夹，就会出现<code>LaunchImage</code>的配置项，然后再把启动图拖进去即可</p>
<p>设置启动图的方式2：在<code>LaunchScreen.xib</code>中设置，编译过后会把”xib”文件进行截图，实际运行的时候再显示该图，要修改”xib”文件的名称，也是想方式1那样，把<code>Launch Images Source</code>设置为<code>Use Asset Catalog</code>，然后在<code>Launch Screen File</code>选择其他的”xib”文件</p>
<h3 id="通知">通知</h3>
<p>通知发布者：</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------NotificationSender.h----------------</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="kw">@interface</span> NotificationSender <span class="op">:</span> NSObject</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>@property <span class="op">(</span>nonatomic<span class="op">,</span> copy<span class="op">)</span> NSString <span class="op">*</span> name<span class="op">;</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------NotificationSender.m----------------</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;NotificationSender.h&quot;</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="kw">@implementation</span> NotificationSender</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span></code></pre></div>
<p>通知监听者：</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------NotificationListener.h----------------</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="kw">@interface</span> NotificationListener <span class="op">:</span> NSObject</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>@property <span class="op">(</span>nonatomic<span class="op">,</span> copy<span class="op">)</span> NSString <span class="op">*</span> name<span class="op">;</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co">//用于监听通知的方法，如果需要获取通知内容，可以写上类型为&quot;NSNotification *&quot;的参数（不需要的话直接无参就行）</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>func1<span class="op">:(</span>NSNotification <span class="op">*)</span>notificationInfo<span class="op">;</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------NotificationListener.m----------------</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;NotificationListener.h&quot;</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="kw">@implementation</span> NotificationListener</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>func1<span class="op">:(</span>NSNotification <span class="op">*)</span>notificationInfo <span class="op">{</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    NSLog<span class="op">(</span><span class="st">@&quot;%@&quot;</span><span class="op">,</span> notificationInfo<span class="op">.</span>name<span class="op">);</span><span class="co">//通知名称</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>    NSLog<span class="op">(</span><span class="st">@&quot;%@&quot;</span><span class="op">,</span> notificationInfo<span class="op">.</span>object<span class="op">);</span><span class="co">//通知发布者</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>    NSLog<span class="op">(</span><span class="st">@&quot;%@&quot;</span><span class="op">,</span> notificationInfo<span class="op">.</span>userInfo<span class="op">);</span><span class="co">//通知内容，字典类型</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a><span class="co">//在销毁之前要移除Observer</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>dealloc <span class="op">{</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">[[</span>NSNotificationCenter defaultCenter<span class="op">]</span> removeObserver<span class="op">:</span><span class="kw">self</span><span class="op">];</span></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>    <span class="co">//使用了ARC就不需要手动管理内存了</span></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">//[super dealloc];</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span></code></pre></div>
<p>调用</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">//----------------main.m----------------</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;NotificationSender.h&quot;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;NotificationListener.h&quot;</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span> argv<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    @autoreleasepool <span class="op">{</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">//创建通知发布者</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>        NotificationSender <span class="op">*</span> sender1 <span class="op">=</span> <span class="op">[[</span>NotificationSender alloc<span class="op">]</span> init<span class="op">];</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">//创建通知监听者</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>        NotificationListener <span class="op">*</span> listener1 <span class="op">=</span> <span class="op">[[</span>NotificationListener alloc<span class="op">]</span> init<span class="op">];</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">//通过NSNotificationCenter发布和监听通知</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>        NSNotificationCenter <span class="op">*</span> notificationCenter <span class="op">=</span> <span class="op">[</span>NSNotificationCenter defaultCenter<span class="op">];</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">//先监听、在发布</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">//使用 listener1 的 func1: 方法 监听 名字为 notificationName1 的由 sender1 发布的通知</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">//如果通知名称填nil，则会监听sender1发布的所有通知；如果发布者填nil，则会监听所有名字为notificationName1的通知；如果通知名字和发布者都填nil，则会监听所有的通知</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>        <span class="co">//注意要在listener1销毁前removeObserver（一般在dealloc中removeObserver）</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span>notificationCenter addObserver<span class="op">:</span>listener1 selector<span class="op">:</span><span class="kw">@selector</span><span class="op">(</span>func1<span class="op">:)</span> name<span class="op">:</span><span class="st">@&quot;notificationName1&quot;</span> object<span class="op">:</span>sender1<span class="op">];</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">//发布一个名字为 notificationName1 的、由 sender1 发布的、内容为字典内容的通知</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span>notificationCenter postNotificationName<span class="op">:</span><span class="st">@&quot;notificationName1&quot;</span> object<span class="op">:</span>sender1 userInfo<span class="op">:</span>@<span class="op">{</span> <span class="st">@&quot;title&quot;</span> <span class="op">:</span> <span class="st">@&quot;XXX&quot;</span><span class="op">,</span> <span class="st">@&quot;content&quot;</span> <span class="op">:</span> <span class="st">@&quot;xxx&quot;</span><span class="op">}];</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>常用通知： - UIDeviceOrientationDidChangeNotification: 设备旋转 -
UIDeviceBatteryStateDidChangeNotification: 电池状态改变 -
UIDeviceBatteryLevelDidChangeNotification: 电池电量变化 -
UIDeviceProxioityStateDidChangeNotification:
近距离传感器（比如手机贴近脸部） - UIKeyboardWillShowNotification:
键盘即将显示 - UIKeyboardDidShowNotification: 键盘显示完毕 -
UIKeyboardWillHideNotification: 键盘即将隐藏 -
UIKeyboardDidHideNotification: 键盘隐藏完毕 -
UIKeyboardWillChangeFrameNotification: 键盘的位置尺寸即将发生改变 -
UIKeyboardDidChangeFrameNotification: 键盘的位置尺寸改变完毕</p>
<h3 id="键盘">键盘</h3>
<p><strong>收起键盘</strong></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">//方法一：让获取键盘焦点的控件辞去第一响应者</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">//假设txt1是当前的第一响应者（如果当前有很多个输入框，因为无法确定当前谁获取了键盘焦点，所有输入框都得调一次这个方法）</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="kw">self</span><span class="op">.</span>txt1 resignFirstResponder<span class="op">];</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co">//方法二：让所有view的父view结束编辑</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="kw">self</span><span class="op">.</span>view endEditing<span class="op">:</span>YES<span class="op">];</span><span class="co">//self.view是ViewController的属性，代表所有view的父view</span></span></code></pre></div>
<p><strong>使用通知监听键盘弹出、隐藏</strong></p>
<p>一般要把输入框或者其他控件往上移键盘高度的距离</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>NSNotificationCenter <span class="op">*</span> notificationCenter <span class="op">=</span> <span class="op">[</span>NSNotificationCenter defaultCenter<span class="op">];</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>notificationCenter addObserver<span class="op">:</span><span class="kw">self</span> selector<span class="op">:</span><span class="kw">@selector</span><span class="op">(</span>xxx<span class="op">)</span> name<span class="op">:</span>UIKeyboardWillChangeFrameNotification object<span class="op">:</span>nil<span class="op">];</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co">//在对应的方法中获取键盘高度</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co">//keyboardY = [info.userInfo[UIKeyboardFrameEndUserInfoKey] CGRectValue].origin.y;</span></span></code></pre></div>
<h3 id="autolayout">AutoLayout</h3>
<p>为了适配不同大小的屏幕及旋转屏幕的需求，一开始是使用<code>autoresizing</code>来进行屏幕适配的，使用<code>autoresizing</code>可以不固定控件大小，而是设置一个<strong>相对于父控件</strong>的值</p>
<p>从IOS6开始，使用<code>autolayout</code>来进行屏幕适配，<code>autolayout</code>不再局限与父控件和子控件间的大小、位置关系，它还可以设置任意控件间的大小、位置关系</p>
<p>使用<code>size classes</code>+<code>autolayout</code>，可以为不同的尺寸屏幕设置不同的约束</p>
<p>要注意的是，<code>autoresizing</code>和<code>autolayout</code>是互斥的，只能使用其中一种（只要把<code>autolayout</code>取消勾选，那么用的就是<code>autoresizing</code>）；而且一旦使用了<code>autoresizing</code>或<code>autolayout</code>，就不要在代码中设置frame了，否则可能会造成混乱</p>
<p><strong>使用代码添加约束</strong></p>
<p><code>autoresizing</code>或<code>autolayout</code>可以通过<code>storyboard</code>的控制面板的方式添加约束，也可以使用代码添加</p>
<p>使用代码添加约束前要明确： -
如果控件约束不依赖于其他任何控件（即固定值），那么约束是添加到自己身上的
- 如果控件约束依赖于父控件，那么约束是添加到父控件身上的 -
如果控件的约束依赖于兄弟控件，那么约束是添加到第一个共同的父控件身上的</p>
<p>在给控件添加约束时，要把view的<code>translatesAutoresizingMaskIntoConstraints</code>属性设置成<code>NO</code>，且相关的控件必须已经添加到各自的父控件下；添加约束后，就不能再设置frame了</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">//控件1</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>UIView <span class="op">*</span> blueView <span class="op">=</span> <span class="op">[[</span>UIView alloc<span class="op">]</span> init<span class="op">];</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>blueView<span class="op">.</span>backgroundColor <span class="op">=</span> <span class="op">[</span>UIColor blueColor<span class="op">];</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co">//控件2</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>UIView <span class="op">*</span> redView <span class="op">=</span> <span class="op">[[</span>UIView alloc<span class="op">]</span> init<span class="op">];</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>redView<span class="op">.</span>backgroundColor <span class="op">=</span> <span class="op">[</span>UIColor redColor<span class="op">];</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co">//添加到控件中</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="kw">self</span><span class="op">.</span>view addSubview<span class="op">:</span>blueView<span class="op">];</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="kw">self</span><span class="op">.</span>view addSubview<span class="op">:</span>redView<span class="op">];</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="co">//禁用autoresizing</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>blueView<span class="op">.</span>translatesAutoresizingMaskIntoConstraints <span class="op">=</span> NO<span class="op">;</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>redView<span class="op">.</span>translatesAutoresizingMaskIntoConstraints <span class="op">=</span> NO<span class="op">;</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="co">//创建约束</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="co">//A对象的某属性 等于 B对象的某属性乘以multiplier加constant</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>NSLayoutConstraint <span class="op">*</span> blueHC <span class="op">=</span> <span class="op">[</span>NSLayoutConstraint constraintWithItem<span class="op">:</span>blueView attribute<span class="op">:</span>NSAttributeHeight relateBy<span class="op">:</span>NSLayoutRelationEqual toItem<span class="op">:</span>nil attribute<span class="op">:</span>NSAttributeNotAnAttribute multiplier<span class="op">:</span><span class="fl">1.0</span> constant<span class="op">:</span><span class="dv">50</span><span class="op">];</span><span class="co">//高度约束</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>NSLayoutConstraint <span class="op">*</span> blueLeft <span class="op">=</span> <span class="op">[</span>NSLayoutConstraint constraintWithItem<span class="op">:</span>blueView attribute<span class="op">:</span>NSAttributeLeft relateBy<span class="op">:</span>NSLayoutRelationEqual toItem<span class="op">:</span>blueView<span class="op">.</span>superView attribute<span class="op">:</span>NSAttributeLeft multiplier<span class="op">:</span><span class="fl">1.0</span> constant<span class="op">:</span><span class="dv">20</span><span class="op">];</span><span class="co">//左边离父控件左边20</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>NSLayoutConstraint <span class="op">*</span> blueTop <span class="op">=</span> <span class="op">[</span>NSLayoutConstraint constraintWithItem<span class="op">:</span>blueView attribute<span class="op">:</span>NSAttributeTop relateBy<span class="op">:</span>NSLayoutRelationEqual toItem<span class="op">:</span><span class="kw">self</span><span class="op">.</span>topLayoutGuide attribute<span class="op">:</span>NSAttributeBottom multiplier<span class="op">:</span><span class="fl">1.0</span> constant<span class="op">:</span><span class="dv">40</span><span class="op">];</span><span class="co">//上边离状态栏下边40</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>NSLayoutConstraint <span class="op">*</span> blueRight <span class="op">=</span> <span class="op">[</span>NSLayoutConstraint constraintWithItem<span class="op">:</span>blueView attribute<span class="op">:</span>NSAttributeRight relateBy<span class="op">:</span>NSLayoutRelationEqual toItem<span class="op">:</span>blueView<span class="op">.</span>superView attribute<span class="op">:</span>NSAttributeRight multiplier<span class="op">:</span><span class="fl">1.0</span> constant<span class="op">:-</span><span class="dv">20</span><span class="op">];</span><span class="co">//右边离父控件右边-20（如果是正的就超出父控件了）</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>blueView addConstraint<span class="op">:</span>blueHC<span class="op">];</span><span class="co">//没有依赖其他控件，约束添加给自己</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>blueView<span class="op">.</span>superView addConstraint<span class="op">:</span>blueLeft<span class="op">];</span><span class="co">//依赖于父控件，约束添加给父控件</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>blueView<span class="op">.</span>superView addConstraint<span class="op">:</span>blueTop<span class="op">];</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>blueView<span class="op">.</span>superView addConstraint<span class="op">:</span>blueRight<span class="op">];</span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>NSLayoutConstraint <span class="op">*</span> redHC <span class="op">=</span> <span class="op">[</span>NSLayoutConstraint constraintWithItem<span class="op">:</span>redView attribute<span class="op">:</span>NSAttributeHeight relateBy<span class="op">:</span>NSLayoutRelationEqual toItem<span class="op">:</span>blueView attribute<span class="op">:</span>NSAttributeNotAnAttribute multiplier<span class="op">:</span><span class="fl">1.0</span> constant<span class="op">:</span><span class="dv">0</span><span class="op">];</span><span class="co">//高度和blueView保持一致</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>NSLayoutConstraint <span class="op">*</span> redTop <span class="op">=</span> <span class="op">[</span>NSLayoutConstraint constraintWithItem<span class="op">:</span>redView attribute<span class="op">:</span>NSAttributeTop relateBy<span class="op">:</span>NSLayoutRelationEqual toItem<span class="op">:</span>blueView attribute<span class="op">:</span>NSAttributeBottom multiplier<span class="op">:</span><span class="fl">1.0</span> constant<span class="op">:</span><span class="dv">40</span><span class="op">];</span><span class="co">//上边离blueView下边40</span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>NSLayoutConstraint <span class="op">*</span> redRight <span class="op">=</span> <span class="op">[</span>NSLayoutConstraint constraintWithItem<span class="op">:</span>redView attribute<span class="op">:</span>NSAttributeRight relateBy<span class="op">:</span>NSLayoutRelationEqual toItem<span class="op">:</span>blueView attribute<span class="op">:</span>NSAttributeRight multiplier<span class="op">:</span><span class="fl">1.0</span> constant<span class="op">:</span><span class="dv">0</span><span class="op">];</span><span class="co">//右边和blueView右边对齐</span></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>NSLayoutConstraint <span class="op">*</span> redWidth <span class="op">=</span> <span class="op">[</span>NSLayoutConstraint constraintWithItem<span class="op">:</span>redView attribute<span class="op">:</span>NSAttributeWidth relateBy<span class="op">:</span>NSLayoutRelationEqual toItem<span class="op">:</span>blueView attribute<span class="op">:</span>NSAttributeWidth multiplier<span class="op">:</span><span class="fl">0.5</span> constant<span class="op">:</span><span class="dv">200</span><span class="op">];</span><span class="co">//宽度是blueView的一半</span></span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="kw">self</span><span class="op">.</span>view addConstraint<span class="op">:</span>blueHC<span class="op">];</span><span class="co">//依赖于blueView，由于是兄弟关系，约束添加到第一个相同的父控件中</span></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="kw">self</span><span class="op">.</span>view addConstraint<span class="op">:</span>blueTop<span class="op">];</span></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="kw">self</span><span class="op">.</span>view addConstraint<span class="op">:</span>blueRight<span class="op">];</span></span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="kw">self</span><span class="op">.</span>view addConstraint<span class="op">:</span>blueLeft<span class="op">];</span></span></code></pre></div>
<h3 id="多线程">多线程</h3>
<p>在IOS下，一个主线程（UI线程）默认占1M的内存空间，一个子线程默认占512K的内存空间</p>
<p>在Objective-C中使用多线程可以使用C的多线程，也可以使用Objective-C的多线程</p>
<table style="width:100%;">
<colgroup>
<col style="width: 11%" />
<col style="width: 62%" />
<col style="width: 4%" />
<col style="width: 12%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr>
<th>方案</th>
<th>简介</th>
<th>语言</th>
<th>生命周期管理</th>
<th>使用频率</th>
</tr>
</thead>
<tbody>
<tr>
<td>pthread</td>
<td>适用于Unix、Linux、Windows等系统，可跨平台/可移植，但是难用</td>
<td>C</td>
<td>程序员管理</td>
<td>几乎不用</td>
</tr>
<tr>
<td>NSThread</td>
<td>更面向对象</td>
<td>OC</td>
<td>程序员管理</td>
<td>偶尔使用</td>
</tr>
<tr>
<td>GCD</td>
<td>对多核CPU利用率更高</td>
<td>C</td>
<td>自动管理</td>
<td>经常使用</td>
</tr>
<tr>
<td>NSOperation</td>
<td>基于GCD，更面向对象</td>
<td>OC</td>
<td>自动管理</td>
<td>经常使用</td>
</tr>
</tbody>
</table>
<p><strong>pthread</strong></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;Foundation/Foundation.h&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&lt;pthread/pthread.h&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> <span class="op">*</span>test<span class="op">(</span><span class="dt">void</span> <span class="op">*</span>param<span class="op">)</span> <span class="op">{</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    NSString <span class="op">*</span>param1 <span class="op">=</span> <span class="op">(</span>__bridge NSString <span class="op">*)</span>param<span class="op">;</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    NSLog<span class="op">(</span><span class="st">@&quot;test: %@, %@&quot;</span><span class="op">,</span> param1<span class="op">,</span> <span class="op">[</span>NSThread currentThread<span class="op">]);</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> NULL<span class="op">;</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span> argv<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">//线程编号的地址</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    pthread_t pthread<span class="op">;</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">/*</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="co">    参数1：线程的编号地址</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="co">    参数2：线程的属性</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="co">    参数3：线程要执行的方法的函数指针，类型为&quot;void * (*)(void *)&quot;（&quot;void *&quot;表示指向任意类型的指针），即返回值是任意类型 的 方法名任意 的 任意参数类型 的函数</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co">    参数4：线程要执行的方法的参数</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="co">    返回值：是否创建成功，0表示成功、非0表示失败</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="co">    char *param = &quot;hello&quot;;</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="co">    int result = pthread_create(&amp;pthread, NULL, test, param);//这是C的函数，使用的空类型是NULL，而不是nil</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="co">    */</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">//使用”__bridge“可以在把Objective-C的对象传给C的函数时，让ARC去自动管理内存</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>    NSString <span class="op">*</span>param <span class="op">=</span> <span class="st">@&quot;hello&quot;</span><span class="op">;</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> result <span class="op">=</span> pthread_create<span class="op">(&amp;</span>pthread<span class="op">,</span> NULL<span class="op">,</span> test<span class="op">,</span> <span class="op">(</span>__bridge <span class="dt">void</span> <span class="op">*)</span>param<span class="op">);</span><span class="co">//这是C的函数，使用的空类型是NULL，而不是nil</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span><span class="op">(</span>result <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>        NSLog<span class="op">(</span><span class="st">@&quot;成功 %@&quot;</span><span class="op">,</span> <span class="op">[</span>NSThread currentThread<span class="op">]);</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>        NSLog<span class="op">(</span><span class="st">@&quot;失败 %@&quot;</span><span class="op">,</span> <span class="op">[</span>NSThread currentThread<span class="op">]);</span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>NSThread</strong></p>
<p>线程的状态：<code>新建(New)</code>–(调用start后)–&gt;<code>就绪(Runnable)</code>—-&gt;<code>运行(Running)</code>（或<code>阻塞(Blocked)</code>—-&gt;<code>就绪(Runnable)</code>—-&gt;<code>运行(Running)</code>）—-&gt;<code>死亡(Dead)</code></p>
<p>可以通过调用<code>[NSThread exit]</code>强制退出当前线程，线程执行完或强制退出后都会自动销毁，线程销毁后无法重用，应该把对应的变量设置为nil</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;ViewController.h&quot;</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="kw">@interface</span> ViewController <span class="op">()</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="kw">@implementation</span> ViewController</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>test1 <span class="op">{</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>NSThread sleepForTimeInterval<span class="op">:</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    NSLog<span class="op">(</span><span class="st">@&quot;test1: %@&quot;</span><span class="op">,</span> <span class="op">[</span>NSThread currentThread<span class="op">]);</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">//开启子线程的消息循环</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">[[</span>NSRunLoop currentRunLoop<span class="op">]</span> run<span class="op">];</span><span class="co">//不设置mode表示使用默认模式</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    NSLog<span class="op">(</span><span class="st">@&quot;end&quot;</span><span class="op">);</span><span class="co">//使用run开启消息循环并且有输入源时，消息循环会一直运行，导致后面的代码无法执行（如果没有添加输入源，消息循环会立即退出）</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">//也可以指定消息循环的运行时间</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">//[[NSRunLoop currentRunLoop] runUntilDate:[NSDate dateWithTimeIntervalSinceNow:2]];//运行2秒</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>test2 <span class="op">{</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>    NSLog<span class="op">(</span><span class="st">@&quot;test2: %@&quot;</span><span class="op">,</span> <span class="op">[</span>NSThread currentThread<span class="op">]);</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>viewDidLoad <span class="op">{</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="kw">super</span> viewDidLoad<span class="op">];</span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">//方式1（需调用start开启）：</span></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>    NSThread <span class="op">*</span> thread <span class="op">=</span> <span class="op">[[</span>NSThread alloc<span class="op">]</span> initWithTarget<span class="op">:</span><span class="kw">self</span> selector<span class="op">:</span><span class="kw">@selector</span><span class="op">(</span>test1<span class="op">)</span> object<span class="op">:</span>nil<span class="op">];</span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>    thread<span class="op">.</span>name <span class="op">=</span> <span class="st">@&quot;t1&quot;</span><span class="op">;</span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>    thread<span class="op">.</span>threadPriority <span class="op">=</span> <span class="fl">1.0</span><span class="op">;</span><span class="co">//线程优先级取值范围是0~1，默认为0.5</span></span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>thread start<span class="op">];</span></span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">//可以指定在哪条线程上执行某个方法，但是要先开启该线程的消息循环（即往子线程的消息循环添加输入源，类似线程池，线程创建后不会被销毁，而是等待新的任务去执行）</span></span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="kw">self</span> performSelector<span class="op">:</span><span class="kw">@selector</span><span class="op">(</span>test2<span class="op">)</span> onThread<span class="op">:</span>thread withObject<span class="op">:</span>nil waitUntilDone<span class="op">:</span>NO<span class="op">];</span><span class="co">//waitUntilDone是否等线程执行完再往后执行//不设置mode表示使用默认模式</span></span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">/*</span></span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a><span class="co">    //方式2（自动开启线程）：</span></span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a><span class="co">    [NSThread detachNewThreadSelector:@selector(test1) toTarget:self withObject:nil];</span></span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a><span class="co">    */</span></span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">//方式3（自动开启线程）：</span></span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a>    <span class="co">//[self performSelectorInBackgroun:@selector(test1) withObject:nil];</span></span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span></code></pre></div>
<p>使用多线程时要注意： -
所有<code>UIKit</code>提供的类都是线程不安全的，为保证数据一致性，所有更新UI的方法都必须在主线程进行（<code>performSelectorOnMainThread</code>）
- 所有包含<code>Mutable</code>的类都是线程不安全的 -
主线程的消息循环默认开启，子线程的消息循环默认是不开启的，如果需要在子线程中使用消息循环，需使用<code>[[NSRunLoop currentRunLoop] run]</code>开启</p>
<p>资源共享问题，解决方式：使用<code>@synchronized</code>加锁，这种锁是互斥锁，和Java一样，两条线程需要使用同一对象做锁</p>
<p>注意：<code>atomic</code>类型的变量使用的是自旋锁，它只能保证同一时间只有一条线程写入，但仍然可以有多条线程同时读取，所以不能保证数据一致性</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode objectivec"><code class="sourceCode objectivec"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#import </span><span class="im">&quot;ViewController.h&quot;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="kw">@interface</span> ViewController <span class="op">()</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>@property <span class="op">(</span>nonatomic<span class="op">,</span> assgin<span class="op">)</span> <span class="dt">int</span> tickets<span class="op">;</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="kw">@implementation</span> ViewController</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>viewDidLoad <span class="op">{</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="kw">super</span> viewDidLoad<span class="op">];</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">self</span><span class="op">.</span>tickets <span class="op">=</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>touchesBegan<span class="op">:(</span>NSSet<span class="op">&lt;</span>UITouch <span class="op">*&gt;)</span>touches withEvent<span class="op">:(</span>UIEvent <span class="op">*)</span>event <span class="op">{</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    NSThread <span class="op">*</span> thread1 <span class="op">=</span> <span class="op">[[</span>NSThread alloc<span class="op">]</span> initWithTarget<span class="op">:</span><span class="kw">self</span> selector<span class="op">:</span><span class="kw">@selector</span><span class="op">(</span>sellTickets<span class="op">)</span> object<span class="op">:</span>nil<span class="op">];</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>thread1 start<span class="op">];</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>    NSThread <span class="op">*</span> thread2 <span class="op">=</span> <span class="op">[[</span>NSThread alloc<span class="op">]</span> initWithTarget<span class="op">:</span><span class="kw">self</span> selector<span class="op">:</span><span class="kw">@selector</span><span class="op">(</span>sellTickets<span class="op">)</span> object<span class="op">:</span>nil<span class="op">];</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>thread1 start<span class="op">];</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>sellTickets <span class="op">{</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">while</span><span class="op">(</span>YES<span class="op">)</span> <span class="op">{</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>        @synchronized<span class="op">(</span><span class="kw">self</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>            <span class="kw">if</span><span class="op">(</span><span class="kw">self</span><span class="op">.</span>tickets <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>                <span class="kw">self</span><span class="op">.</span>tickets <span class="op">=</span> <span class="kw">self</span><span class="op">.</span>tickets <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>                NSLog<span class="op">(</span><span class="st">@&quot;剩余票数: %d&quot;</span><span class="op">,</span> <span class="kw">self</span><span class="op">.</span>tickets<span class="op">);</span></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>                <span class="kw">return</span><span class="op">;</span></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a><span class="kw">@end</span></span></code></pre></div>
<p><strong>GCD</strong></p>
<p><strong>NSOperation</strong></p>
</body>
</html>
